

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-site-verification" content="ovwnX0ej2kps4UuJ9NOzNjJcLOQD8JPDLNhe-hMYTMk" />
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NKZBMHZ');</script>
  <!-- End Google Tag Manager -->
  
  <title>Actions &mdash; StackStorm 2.8dev documentation</title>
  

  <link rel="shortcut icon" href="_static/favicon.ico?v4"/>
  
  
    <link rel="canonical" href="https://docs.stackstorm.com/actions.html"/>
  

  
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,300italic,400italic,600,600italic,700,700italic|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="StackStorm 2.8dev documentation" href="index.html"/>
        <link rel="next" title="Sensors and Triggers" href="sensors.html"/>
        <link rel="prev" title="Quick Start" href="start.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NKZBMHZ"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html">
            <svg class="logo"
                xmlns="http://www.w3.org/2000/svg"xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"
                viewBox="0 0 680 120"
                xml:space="preserve">
              <polygon points="116,0 56.8,0 116,48.6"/>
              <polygon points="0.7,120 64.7,120 0.7,69.9"/>
              <path d="M450.756 55.793l-8.824-2.206c-4.584-1.161-7.865-2.744-9.85-4.746c-1.982-1.999-2.977-4.727-2.977-8.181 c0-4.549 1.523-8.071 4.568-10.569c3.045-2.496 7.336-3.744 12.875-3.744c5.881 0 10.4 1.5 13.7 4.4 c3.248 2.9 4.9 7.1 5 12.44h7.031c-0.104-7.25-2.385-12.892-6.85-16.929c-4.465-4.034-10.664-6.053-18.596-6.053 c-7.49 0-13.475 1.846-17.955 5.54c-4.48 3.693-6.721 8.603-6.721 14.723c0 5.5 1.5 9.8 4.4 12.9 c2.957 3.1 8.3 5.6 16 7.567l7.184 1.796c7.047 1.8 11.8 3.8 14.1 6.104c2.361 2.3 3.5 5.5 3.5 9.8 c0 4.652-1.686 8.303-5.053 10.954c-3.369 2.649-7.996 3.975-13.879 3.975c-6.701 0-11.9-1.641-15.594-4.924 s-5.574-7.9-5.643-13.851h-6.926v0.512c0 7.9 2.4 13.9 7.3 18.136c4.855 4.2 11.8 6.3 20.8 6.3 c8.035 0 14.371-1.948 19.006-5.848c4.635-3.897 6.951-9.233 6.951-16.004c0-5.883-1.76-10.499-5.283-13.853 C465.598 60.8 459.5 58 450.8 55.8"/>
              <path d="M494.566 27.527h-6.311v15.648h-7.438v5.13h7.438v39.755c0 4.2 0.7 7.1 1.9 8.6 s3.523 2.4 6.7 2.386c1.129 0 2.328-0.096 3.592-0.281c1.268-0.189 2.666-0.489 4.207-0.899l-0.051-5.027 c-1.744 0.377-3.027 0.625-3.85 0.745c-0.82 0.119-1.555 0.179-2.203 0.179c-1.508 0-2.549-0.375-3.131-1.13 c-0.582-0.751-0.871-2.29-0.871-4.616V48.305h10.105v-5.13h-10.105V27.527z"/>
              <path d="M536.99 41.79c-7.934 0-14.082 2.505-18.443 7.514c-4.359 5.01-6.541 12.081-6.541 21.2 c0 9.1 2.2 16.1 6.5 21.11c4.361 5 10.5 7.5 18.4 7.465c8.002 0 14.189-2.496 18.57-7.491 c4.377-4.992 6.566-12.02 6.566-21.084c0-9.132-2.199-16.203-6.592-21.213C551.141 44.3 545 41.8 537 41.8 M550.686 87.6 c-3.215 4.001-7.779 6.001-13.695 6.001c-5.848 0-10.389-2.016-13.619-6.052c-3.234-4.035-4.85-9.713-4.85-17.032 c0-7.352 1.615-13.047 4.85-17.083c3.23-4.035 7.771-6.053 13.619-6.053c5.916 0 10.5 2 13.7 6 c3.217 4 4.8 9.7 4.8 17.109S553.902 83.6 550.7 87.6"/>
              <path d="M586.008 44.508c-2.789 1.812-4.969 4.549-6.541 8.207v-9.541h-6.105v54.531h6.514V67.644 c0-6.395 1.359-11.2 4.078-14.414c2.719-3.215 6.797-4.823 12.234-4.823h0.822V41.79h-0.717 C592.221 41.8 588.8 42.7 586 44.5"/>
              <path d="M675.166 46.227c-2.926-2.957-7.346-4.437-13.262-4.437c-3.898 0-7.346 0.915-10.338 2.7 s-5.395 4.489-7.207 7.977c-0.891-3.42-2.68-6.062-5.377-7.925c-2.699-1.864-6.08-2.796-10.143-2.796 c-3.791 0-7.162 0.897-10.113 2.693c-2.957 1.795-5.355 4.369-7.199 7.72v-9.029h-5.9v54.532h6.311V64.001 c0-4.925 1.477-8.907 4.428-11.954c2.955-3.042 6.82-4.566 11.6-4.566c3.893 0 6.8 1.1 8.7 3.3 c1.879 2.2 2.8 5.5 2.8 10.054v36.886h6.309V63.54c0-4.821 1.453-8.723 4.361-11.696c2.906-2.976 6.771-4.463 11.592-4.463 c4.07 0 7 1 8.8 2.976c1.775 2 2.7 5.3 2.7 9.85v37.5h6.412V59.692 C679.551 53.7 678.1 49.2 675.2 46.2"/>
              <path d="M118.944 67.886c-2.638-4.731-7.001-9.521-13.085-14.393L41.482 0.8 c-4.365 0.046-7.895 0.271-10.581 0.677c-2.734 0.466-5.502 1.227-8.287 2.282c-7.151 2.9-12.714 7.208-16.671 12.9 C1.991 22.4 0 29 0 36.76c0 2.8 0.4 5.8 1.2 8.973c0.762 3.2 1.8 6.1 3.2 8.8 c1.728 3.2 4.6 7 8.7 11.351c4.111 4.5 9.7 9.6 16.7 15.438c7.149 6.1 14.6 11.9 22.2 17.6 c4.731 3.4 8.8 6.4 12.3 8.825c3.447 2.4 9.3 6.5 17.5 12.247c3.098-0.096 5.736-0.263 7.912-0.451 c1.932-0.193 3.863-0.546 5.789-1.013c1.36-0.283 3.006-0.828 4.933-1.642c7.011-2.849 12.514-7.222 16.523-13.117 c4.048-5.868 6.093-12.454 6.093-19.776C122.984 78.1 121.6 72.7 118.9 67.9"/>
              <path d="M182.358 53.177c-7.319-1.88-12.124-3.735-14.416-5.566c-2.292-1.829-3.435-4.181-3.435-7.054 c0-2.838 1.297-5.215 3.896-7.13c2.599-1.915 5.952-2.873 10.056-2.873c4.958 0 8.9 1.2 11.9 3.6 c2.958 2.4 4.6 5.8 4.8 10.056l11.953-0.051c-0.07-7.352-2.559-13.192-7.466-17.519c-4.908-4.327-11.483-6.49-19.725-6.49 c-8.482 0-15.279 1.976-20.391 5.926c-5.112 3.95-7.669 9.073-7.669 15.363c0 5.9 1.7 10.6 5.2 14 c3.489 3.4 9.5 6.3 17.9 8.49c0.754 0.2 1.9 0.4 3.3 0.822c6.839 1.7 11.2 3.4 13.2 5.2 c1.197 1.1 2.2 2.4 2.9 3.924c0.77 1.5 1.2 2.9 1.2 4.079c0 3.044-1.375 5.609-4.128 7.7 c-2.754 2.087-6.285 3.131-10.595 3.131c-5.711 0-10.234-1.351-13.567-4.053c-3.336-2.702-5.174-6.498-5.514-11.389h-12.212 c0.378 8.5 3.2 15 8.4 19.494c5.214 4.5 12.5 6.8 21.9 6.771c8.893 0 15.997-2.163 21.315-6.49 c5.319-4.324 7.977-10.045 7.977-17.16c0-5.882-1.7-10.465-5.104-13.746C200.73 59 193.5 56 182.4 53.2"/>
              <path d="M233.915 27.117h-11.646v15.236h-7.9v8.721h7.9v34.012c0 5 0.9 8.5 2.8 10.4 c1.899 1.9 5.2 2.9 9.8 2.924c1.366 0 3.726-0.171 7.078-0.513c0.511-0.035 0.905-0.068 1.18-0.103v-9.335l-2.308 0.1 c-0.239 0-0.609 0.018-1.105 0.051c-0.494 0.035-0.895 0.053-1.206 0.053c-1.777 0-2.99-0.333-3.639-1 c-0.651-0.668-0.976-2.01-0.976-4.027V51.074h9.234v-8.721h-9.234V27.117z"/>
              <path d="M299.373 89.498c-1.267 0-2.147-0.325-2.643-0.977c-0.497-0.648-0.745-2.032-0.745-4.153V56.922 c0-5.404-1.871-9.481-5.617-12.234c-3.744-2.754-9.293-4.13-16.647-4.13c-7.011 0-12.541 1.599-16.594 4.8 c-4.053 3.2-6.081 7.551-6.081 13.058v0.923h11.134v-0.41c0-2.805 0.957-4.959 2.872-6.465c1.916-1.505 4.667-2.257 8.259-2.257 c3.865 0 6.7 0.6 8.6 1.897c1.845 1.3 2.8 3.2 2.8 5.9c0 3.283-3.711 5.404-11.133 6.4 c-0.513 0.069-0.908 0.12-1.18 0.153c-8.893 1.129-15.03 3.104-18.416 5.924c-3.386 2.822-5.079 7.038-5.079 12.6 c0 5.1 1.6 9.1 4.7 12.056c3.164 2.9 7.5 4.4 13.1 4.36c3.626 0 7.027-0.794 10.208-2.386 c3.18-1.591 5.899-3.838 8.158-6.746c0.068 2.8 1 4.9 2.7 6.311c1.726 1.4 4.4 2.1 7.9 2.1 c0.925 0 1.89-0.069 2.899-0.205c1.009-0.139 2.044-0.345 3.104-0.616v-8.567c-0.718 0.068-1.224 0.112-1.514 0.1 C299.876 89.5 299.6 89.5 299.4 89.5 M284.547 76.878c0 3.831-1.436 6.976-4.31 9.4 c-2.873 2.464-6.481 3.694-10.825 3.694c-2.873 0-5.095-0.692-6.668-2.079c-1.574-1.384-2.36-3.341-2.36-5.874 c0-2.256 0.667-4.077 2.001-5.463c1.333-1.384 3.368-2.333 6.105-2.847c0.922-0.171 2.36-0.41 4.31-0.717 c5.369-0.787 9.284-1.814 11.747-3.079V76.878z"/>
              <path d="M341.311 86.086c-2.174 2-5.021 3.002-8.542 3.002c-4.411 0-7.78-1.634-10.105-4.9s-3.489-8.01-3.489-14.236 c0-6.359 1.174-11.173 3.515-14.439c2.342-3.267 5.805-4.901 10.389-4.901c3.419 0 6.2 1 8.3 2.8 c2.119 1.9 3.3 4.5 3.6 7.774h11.541c-0.34-6.43-2.643-11.483-6.9-15.161c-4.256-3.676-9.891-5.514-16.902-5.514 c-8.036 0-14.337 2.625-18.902 7.874c-4.566 5.25-6.849 12.492-6.849 21.726c0 9 2.2 16.2 6.6 21.4 c4.411 5.3 10.4 7.9 18 7.899c7.355 0 13.246-1.957 17.675-5.872c4.428-3.917 6.916-9.312 7.463-16.186h-11.389 C344.822 81.2 343.5 84.1 341.3 86.1"/>
              <polygon points="414,42.4 399.7,42.4 377.9,64.9 377.9,22.1 366.4,22.1 366.4,97.7 377.9,97.7 377.9,79.2 385.8,71.2 400.7,97.7 414.4,97.7 394,62.7"/>
            </svg>
          </a>
        
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <p class="caption"><span class="caption-text">はじめに</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">StackStorm 概要</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview.html#about">About</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#how-it-works">How it Works</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#what-s-next">What’s Next?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="install/index.html">インストールと設定</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install/overview.html">デプロイ後の構成</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/system_requirements.html">System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/vagrant.html">Vagrant / OVA</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/deb.html">Ubuntu 14.04 / 16.04</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/rhel7.html">RHEL 7 / CentOS 7</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/rhel6.html">RHEL 6 / CentOS 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/docker.html">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/ansible.html">Ansible Playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/bwc.html">Extreme Workflow Composer</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/config/index.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/upgrades.html">Upgrades</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/uninstall.html">Uninstall</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="start.html">クイックスタート</a><ul>
<li class="toctree-l2"><a class="reference internal" href="start.html#explore-st2-with-cli">Explore StackStorm with CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#authenticate">Authenticate</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#work-with-actions">Work with Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#define-a-rule">Define a Rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#deploy-a-rule">Deploy a Rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#deploy-examples">Deploy Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#datastore">Datastore</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">基本機能</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Actions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#managing-and-running-actions">Managing and Running Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#action-runners">Action Runners</a></li>
<li class="toctree-l2"><a class="reference internal" href="#writing-custom-actions">Writing Custom Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#built-in-parameters">Built-in Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#overriding-runner-parameters">Overriding Runner Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#environment-variables-available-to-actions">Environment Variables Available to Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#converting-existing-scripts-into-actions">Converting Existing Scripts into Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#writing-custom-python-actions">Writing Custom Python Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pre-defined-actions">Pre-defined Actions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sensors.html">Sensors and Triggers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sensors.html#sensors">Sensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensors.html#triggers">Triggers</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensors.html#internal-triggers">Internal Triggers</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensors.html#creating-a-sensor">Creating a Sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensors.html#how-sensors-are-run">How Sensors are Run</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensors.html#sensor-service">Sensor Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensors.html#common-operations">Common Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensors.html#datastore-management-operations">Datastore Management Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensors.html#running-your-first-sensor">Running Your First Sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensors.html#examples">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensors.html#debugging-a-sensor-from-a-pack">Debugging a Sensor From a Pack</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rules.html">Rules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rules.html#rule-structure">Rule Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#trigger">Trigger</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#criteria">Criteria</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#critera-comparison">Critera Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#advanced-comparison">Advanced Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#action">Action</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#variable-interpolation">Variable Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#managing-rules">Managing Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#rule-location">Rule Location</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#testing-rules">Testing Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#timers">Timers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="workflows.html">Workflows</a><ul>
<li class="toctree-l2"><a class="reference internal" href="actionchain.html">ActionChain</a></li>
<li class="toctree-l2"><a class="reference internal" href="mistral.html">Mistral</a></li>
<li class="toctree-l2"><a class="reference internal" href="mistral_yaql.html">Mistral + YAQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="mistral_jinja.html">Mistral + Jinja</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudslang.html">CloudSlang</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="packs.html">Packs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="packs.html#what-is-a-pack">What is a Pack?</a></li>
<li class="toctree-l2"><a class="reference internal" href="packs.html#managing-packs">Managing Packs</a></li>
<li class="toctree-l2"><a class="reference internal" href="packs.html#discovering-packs">Discovering Packs</a></li>
<li class="toctree-l2"><a class="reference internal" href="packs.html#installing-a-pack">Installing a Pack</a></li>
<li class="toctree-l2"><a class="reference internal" href="packs.html#configuring-a-pack">Configuring a Pack</a></li>
<li class="toctree-l2"><a class="reference internal" href="packs.html#developing-a-pack">Developing a Pack</a></li>
<li class="toctree-l2"><a class="reference internal" href="packs.html#advanced-topics">Advanced Topics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="webhooks.html">Webhooks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="webhooks.html#sensors-vs-webhooks">Sensors vs Webhooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="webhooks.html#authentication">Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="webhooks.html#request-body">Request Body</a></li>
<li class="toctree-l2"><a class="reference internal" href="webhooks.html#registering-a-webhook">Registering a Webhook</a></li>
<li class="toctree-l2"><a class="reference internal" href="webhooks.html#using-a-generic-webhook">Using a Generic Webhook</a></li>
<li class="toctree-l2"><a class="reference internal" href="webhooks.html#listing-registered-webhooks">Listing Registered Webhooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="webhooks.html#my-webhook-isn-t-working">My Webhook Isn’t Working!</a></li>
<li class="toctree-l2"><a class="reference internal" href="webhooks.html#when-not-to-use-webhooks">When Not to Use Webhooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="datastore.html">データストア</a><ul>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#cli-key-value">CLI による Key-Value ペアの登録と取得方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#cli">CLI からの数値、オブジェクト、配列値の登録・取得</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#key-value">ファイルから key-value ペアを読み込む方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#datastore-scopes-in-key-value-store">データのスコープ設定</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#ttl">登録データの TTL</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#python-client">Python Client から値を設定・取得</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#referencing-key-value-pairs-in-action-definitions">アクション定義ファイルから key-value ペアを取得する方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#id4">ルール定義ファイルから key-value ペアを参照する</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#admin-setup-for-encrypted-datastore">登録データの暗号化設定 (管理者のみ)</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#datastore-storing-secrets-in-key-value-store">暗号化データの保存</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#id7">セキュリティノート</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chatops/index.html">ChatOps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chatops/chatops.html">What is ChatOps?</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatops/chatops.html#architecture">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatops/chatops.html#stackstorm-flavored-chatops">StackStorm-flavored ChatOps</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatops/chatops.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatops/chatops.html#adding-new-chatops-commands">Adding New ChatOps Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatops/chatops.html#logging">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatops/aliases.html">Action Aliases</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatops/notifications.html">Notifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatops/pack_deploy.html">Pack Deployment</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">応用トピック</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Authentication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#configuring-the-service">Configuring the Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#standalone-auth-mode">Standalone Auth Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#proxy-auth-mode">Proxy Auth Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#auth-backends">Auth Backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#ldap-enterprise-edition">LDAP (Enterprise Edition)</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#running-the-service">Running the Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#testing">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#api-keys">API Keys</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rbac.html">Role Based Access Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#terminology">Terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#system-roles">System Roles</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#how-it-works">How it Works</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#enabling-rbac">Enabling RBAC</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#defining-roles-and-assignments">Defining Roles and Assignments</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#applying-rbac-definitions">Applying RBAC Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#automatically-granting-roles-based-on-ldap-group-membership">Automatically Granting Roles Based on LDAP Group Membership</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#restricting-users-to-only-view-resources-they-own-or-created">Restricting Users to Only View Resources They Own or Created</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#using-rbac-example">Using RBAC Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="inquiries.html">Inquiries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="inquiries.html#new-core-ask-action">New <code class="docutils literal notranslate"><span class="pre">core.ask</span></code> Action</a></li>
<li class="toctree-l2"><a class="reference internal" href="inquiries.html#using-core-ask-in-a-workflow">Using <code class="docutils literal notranslate"><span class="pre">core.ask</span></code> in a Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="inquiries.html#notifying-users-of-inquiries-using-rules">Notifying Users of Inquiries using Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="inquiries.html#responding-to-an-inquiry">Responding to an Inquiry</a></li>
<li class="toctree-l2"><a class="reference internal" href="inquiries.html#securing-inquiries">Securing Inquiries</a></li>
<li class="toctree-l2"><a class="reference internal" href="inquiries.html#garbage-collection-for-inquiries">Garbage Collection for Inquiries</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference/index.html">References and Guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="reference/sharing_code_sensors_actions.html">Sharing code between Sensors and Python Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/cli.html">CLI Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/pack_configs.html">Pack Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/packs.html">Create and Contribute a Pack</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/pack_management_transition.html">Pack Management Transition</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/action_output_streaming.html">Real-time Action Output Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/content_version.html">Using a Specific Version of Pack Content When Running an Action</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/jinja.html">Jinja</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/policies.html">Policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/runners.html">Action Runners</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/traces.html">Traces</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/client_libraries.html">Client Libraries and Language Bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/ha.html">High Availability Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/api.html">REST API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/monitoring.html">System Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/sensor_partitioning.html">Partitioning Sensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/history.html">History and Audit</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/secrets_masking.html">Secrets Masking</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting/index.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/self_verification.html">Running Self-Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/basic_chatops_troubleshooting.html">ChatOps Troubleshooting Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/rules.html">Rule is not Being Matched</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/sensors.html">Sensor Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/mistral.html">Mistral Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/ssh.html">SSH Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/database.html">Database Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/rest_api_access.html">REST API access</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/tuning_action_runner_dispatcher_pool.html">Tuning Action Runner Dispatcher Pool Size</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/purging_old_data.html">Purging Old Operational Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/private_networks.html">WebUI Access on Private Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/submit_debug_info.html">Submitting Debugging Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/debug_mode.html">Enabling Debug Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/ask_for_support.html">Ask for help!</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/webhooks.html">Troubleshooting Webhooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="development/index.html">Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="development/index.html#contributing">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="development/index.html#setting-up-a-development-environment">Setting up a Development Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="development/index.html#general-contribution-guidelines">General Contribution Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="development/index.html#code-style-guide">Code Style Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="development/index.html#deprecation-policy">Deprecation Policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="development/index.html#general-coding-guidelines">General Coding Guidelines</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Release Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#in-development">in development</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#may-16-2018">2.7.2 - May 16, 2018</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#april-20-2018">2.7.1 - April 20, 2018</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#april-12-2018">2.7.0 - April 12, 2018</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#january-19-2018">2.6.0 - January 19, 2018</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#december-14-2017">2.5.1 - December 14, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#october-25-2017">2.5.0 - October 25, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#september-12-2017">2.4.1 - September 12, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#august-23-2017">2.4.0 - August 23, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#july-28-2017">2.3.2 - July 28, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#july-07-2017">2.3.1 - July 07, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#june-19-2017">2.3.0 - June 19, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#april-3-2017">2.2.1 - April 3, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#february-27-2017">2.2.0 - February 27, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#december-16-2016">2.1.1 - December 16, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#december-05-2016">2.1.0 - December 05, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#september-30-2016">2.0.1 - September 30, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#august-31-2016">2.0.0 - August 31, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#august-8-2016">1.6.0 - August 8, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#july-13-2016">1.5.1 - July 13, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#june-24-2016">1.5.0 - June 24, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#april-18-2016">1.4.0 - April 18, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#february-12-2016">1.3.2 - February 12, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#january-25-2016">1.3.1 - January 25, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#january-22-2016">1.3.0 - January 22, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#december-07-2015">1.2.0 - December 07, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#november-13-2015">1.1.1 - November 13, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#october-27-2015">1.1.0 - October 27, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#september-09-2015">0.13.2 - September 09, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#august-28-2015">0.13.1 - August 28, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#august-24-2015">0.13.0 - August 24, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#august-11-2015">0.12.2 - August 11, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#july-31-2015">0.12.1 - July 31, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#july-20-2015">0.12.0 - July 20, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#july-2-2015">0.11.6 - July 2, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#july-1-2015">0.11.5 - July 1, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#june-30-2015">0.11.4 - June 30, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#june-16-2015">0.11.3 - June 16, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#june-12-2015">0.11.2 - June 12, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#june-8-2015">0.11.1 - June 8, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#june-5-2015">0.11.0 - June 5, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-9-2-may-26-2015">v0.9.2 - May 26, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-9-1-may-12-2015">v0.9.1 - May 12, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-9-0-april-29-2015">v0.9.0 - April 29, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-8-3-march-23-2015">v0.8.3 - March 23, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-8-2-march-10-2015">v0.8.2 - March 10, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-8-1-march-10-2015">v0.8.1 - March 10, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-8-0-march-2-2015">v0.8.0 - March 2, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-7-january-16-2015">v0.7 - January 16, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-6-0-december-8-2014">v0.6.0 - December 8, 2014</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-5-1-november-3rd-2014">v0.5.1 - November 3rd, 2014</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="upgrade_notes.html">Upgrade Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v2-7">StackStorm v2.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v2-6">StackStorm v2.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v2-5">StackStorm v2.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v2-4">StackStorm v2.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v2-3">StackStorm v2.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v2-2">StackStorm v2.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v2-1">StackStorm v2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v2-0">StackStorm v2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v1-6">StackStorm v1.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v1-5">StackStorm v1.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v1-4">StackStorm v1.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v1-3">StackStorm v1.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v1-2">StackStorm v1.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v1-1">StackStorm v1.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v-0-11">StackStorm v 0.11</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v0-9">StackStorm v0.9</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap</a><ul>
<li class="toctree-l2"><a class="reference internal" href="roadmap.html#eta-june-2018">2.8 - ETA June 2018</a></li>
<li class="toctree-l2"><a class="reference internal" href="roadmap.html#eta-august-2018">2.9 - ETA August 2018</a></li>
<li class="toctree-l2"><a class="reference internal" href="roadmap.html#eta-october-2018">3.0 - ETA October 2018</a></li>
<li class="toctree-l2"><a class="reference internal" href="roadmap.html#backlog">Backlog</a></li>
<li class="toctree-l2"><a class="reference internal" href="roadmap.html#release-history">Release History</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">StackStorm</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs v2.8dev </a> &raquo;</li>
        
      <li>Actions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/StackStorm/st2docs/blob/master/docs/source/actions.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document">
            <div id="version-warning" class="admonition warning hide">
              <p class="first admonition-title">Note</p>
              <p class="last">
                The documentation you're currently reading is for version 2.8dev.
                Click <a href="/">here</a> to view documentation for the latest stable version.
              </p>
            </div>
            
  <div class="section" id="actions">
<h1>Actions<a class="headerlink" href="#actions" title="Permalink to this headline">¶</a></h1>
<p>Actions are pieces of code that can perform arbitrary automation or remediation tasks in your
environment. They can be written in any programming language.</p>
<p>To give you a better idea, here is a short list of tasks which can be implemented as actions:</p>
<ul class="simple">
<li>restart a service on a server</li>
<li>create a new cloud server</li>
<li>acknowledge a Nagios/PagerDuty alert</li>
<li>send a notification or alert via email or SMS</li>
<li>send a notification to an IRC channel</li>
<li>send a message to Slack</li>
<li>start a Docker container</li>
<li>snapshot a VM</li>
<li>run a Nagios check</li>
</ul>
<p>Actions can be executed when a <a class="reference internal" href="rules.html"><span class="doc">Rule</span></a> with matching criteria is triggered. Multiple
actions can be strung together into a <a class="reference internal" href="workflows.html"><span class="doc">Workflow</span></a>. Actions can also be executed
directly from the clients via CLI, API, or UI.</p>
<div class="section" id="managing-and-running-actions">
<h2>Managing and Running Actions<a class="headerlink" href="#managing-and-running-actions" title="Permalink to this headline">¶</a></h2>
<p>The CLI provides access to action management commands using the <code class="docutils literal notranslate"><span class="pre">st2</span> <span class="pre">action</span> <span class="pre">&lt;command&gt;</span></code> format.
To see a list of available commands and their description, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>st2 action --help
</pre></div>
</div>
<p>To get more information on a particular action command, run: <code class="docutils literal notranslate"><span class="pre">st2</span> <span class="pre">action</span> <span class="pre">&lt;command&gt;</span> <span class="pre">-h</span></code>. For
example, the following will provide help for the action list command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>st2 action list -h
</pre></div>
</div>
<p>The following commands show examples of how to obtain information on available actions and their
arguments:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># List all available actions (note that output may be lengthy)</span>
st2 action list

<span class="c1"># List all actions in &quot;linux&quot; pack</span>
st2 action list -p linux

<span class="c1"># Display information for a particular action linux.check_loadavg</span>
st2 action get linux.check_loadavg

<span class="c1"># Alternatively, use CLI&#39;s run script to obtain information on an action&#39;s arguments:</span>
st2 run linux.check_loadavg -h
</pre></div>
</div>
<p>To execute an action manually, you can use <code class="docutils literal notranslate"><span class="pre">st2</span> <span class="pre">run</span> <span class="pre">&lt;action</span> <span class="pre">with</span> <span class="pre">parameters&gt;</span></code> or
<code class="docutils literal notranslate"><span class="pre">st2</span> <span class="pre">action</span> <span class="pre">execute</span> <span class="pre">&lt;action</span> <span class="pre">with</span> <span class="pre">parameters&gt;</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Execute action immediately and display the results</span>
st2 run core.http <span class="nv">url</span><span class="o">=</span><span class="s2">&quot;http://httpbin.org/get&quot;</span>

<span class="c1"># Schedule action execution</span>
st2 action execute core.http <span class="nv">url</span><span class="o">=</span><span class="s2">&quot;http://httpbin.org/get&quot;</span>

<span class="c1"># Obtain execution results (the command below is provided as a tip in the output of the above command):</span>
st2 execution get 54fc83b9e11c711106a7ae01

<span class="c1"># If you want to add a trace tag to execution when you run it, you can use:</span>
st2 run core.local <span class="nv">cmd</span><span class="o">=</span>date --trace-tag<span class="o">=</span><span class="s2">&quot;simple-date-check-`date +%s`&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="action-runners">
<h2>Action Runners<a class="headerlink" href="#action-runners" title="Permalink to this headline">¶</a></h2>
<p>An action runner is the execution environment for user-implemented actions. StackStorm comes with
pre-canned action runners such as a remote runner and shell runner which provide for
user-implemented actions to be run remotely (via SSH) and locally. The objective is to allow the
action author to concentrate only on the implementation of the action itself rather than setting
up the environment.</p>
<div class="section" id="available-runners">
<h3>Available Runners<a class="headerlink" href="#available-runners" title="Permalink to this headline">¶</a></h3>
<p>The environment in which the action runs is specified by the runner. Currently the system provides
the following runners:</p>
<ol class="arabic">
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">local-shell-cmd</span></code> - This is the local runner. This runner executes a Linux command on the
host where StackStorm is running.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">local-shell-script</span></code> - This is the local runner. Actions are implemented as scripts. They are
executed on the hosts where StackStorm is running.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">remote-shell-cmd</span></code> - This is a remote runner. This runner executes a Linux command on one or
more remote hosts provided by the user.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">remote-shell-script</span></code> - This is a remote runner. Actions are implemented as scripts. They run
on one or more remote hosts provided by the user.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">python-script</span></code> - This is a Python runner. Actions are implemented as Python classes with a
<code class="docutils literal notranslate"><span class="pre">run()</span></code> method. They run locally on the same machine where StackStorm components are running. The
return value from the action <code class="docutils literal notranslate"><span class="pre">run()</span></code> method is either a tuple of success status flag and the
result object respectively or it is just the result object. For more information, please refer
to the <a class="reference internal" href="reference/runners.html"><span class="doc">Action Runners</span></a> section in the documentation.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">http-request</span></code> - HTTP client which performs HTTP requests for running HTTP actions.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">action-chain</span></code> - This runner supports executing simple linear work-flows. For more
information, please refer to the <a class="reference internal" href="workflows.html"><span class="doc">Workflows</span></a> and
<a class="reference internal" href="actionchain.html"><span class="doc">ActionChain</span></a> documentation.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">mistral-v2</span></code> - This runner is built on top of the Mistral OpenStack project and supports
executing complex work-flows. For more information, please refer to the
<a class="reference internal" href="workflows.html"><span class="doc">Workflows</span></a> and <a class="reference internal" href="mistral.html"><span class="doc">Mistral</span></a> documentation.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">cloudslang</span></code> - This runner is built on top of the CloudSlang project and supports executing
complex workflows. For more information, please refer to the <a class="reference internal" href="workflows.html"><span class="doc">Workflows</span></a> and
<a class="reference internal" href="cloudslang.html"><span class="doc">CloudSlang</span></a> documentation.</p>
<p>Note: This runner is currently in an experimental phase which means that there might be
bugs and the external user-facing API might change.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">inquirer</span></code> - This runner provides the core logic of the <a class="reference internal" href="inquiries.html"><span class="doc">Inquiries</span></a>
feature.</p>
<p>Note: This runner is an implementation detail for the <code class="docutils literal notranslate"><span class="pre">core.ask</span></code> action, and in most cases
should not be referenced in other actions.</p>
</li>
</ol>
<p>Runners come with their own set of input parameters. When an action is executed, it inherits the
runner parameters, in addition to its own parameters.</p>
</div>
</div>
<div class="section" id="writing-custom-actions">
<span id="ref-actions-writing-custom"></span><h2>Writing Custom Actions<a class="headerlink" href="#writing-custom-actions" title="Permalink to this headline">¶</a></h2>
<p>An action is composed of two parts:</p>
<ol class="arabic simple">
<li>A YAML metadata file which describes the action, and its inputs.</li>
<li>A script file which implements the action logic</li>
</ol>
<p>As noted above, an action script can be written in an arbitrary programming language, as long as
it follows these conventions:</p>
<ol class="arabic simple">
<li>Script should exit with <code class="docutils literal notranslate"><span class="pre">0</span></code> status code on success and non-zero on error
(e.g. <code class="docutils literal notranslate"><span class="pre">1</span></code>)</li>
<li>All log messages should be printed to standard error</li>
</ol>
<div class="section" id="action-metadata">
<h3>Action Metadata<a class="headerlink" href="#action-metadata" title="Permalink to this headline">¶</a></h3>
<p>Action metadata is used to describe the action and is defined as YAML. These attributes can be
present in the metadata file:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">name</span></code> - Name of the action.</li>
<li><code class="docutils literal notranslate"><span class="pre">runner_type</span></code> - The type of runner to execute the action.</li>
<li><code class="docutils literal notranslate"><span class="pre">enabled</span></code> - Action cannot be invoked when disabled.</li>
<li><code class="docutils literal notranslate"><span class="pre">entry_point</span></code> - Location of the action launch script relative to the
<code class="docutils literal notranslate"><span class="pre">/opt/stackstorm/packs/${pack_name}/actions/</span></code> directory.</li>
<li><code class="docutils literal notranslate"><span class="pre">parameters</span></code> - A dictionary of parameters and optional metadata describing type and default.
The metadata is structured data following the <a class="reference external" href="http://json-schema.org/documentation.html">JSON Schema</a> specification draft 4. The common
parameter types allowed are <code class="docutils literal notranslate"><span class="pre">string</span></code>, <code class="docutils literal notranslate"><span class="pre">boolean</span></code>, <code class="docutils literal notranslate"><span class="pre">number</span></code> (whole numbers and decimal
numbers - e.g. <code class="docutils literal notranslate"><span class="pre">1.0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">3.3333</span></code>, etc.), <code class="docutils literal notranslate"><span class="pre">object</span></code>, <code class="docutils literal notranslate"><span class="pre">integer</span></code> (whole numbers only -
<code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">1000</span></code>, etc.) and <code class="docutils literal notranslate"><span class="pre">array</span></code>. If metadata is provided, input args are validated on
action execution. Otherwise, validation is skipped.</li>
</ul>
<p>This is a sample metadata file for a Python action which sends an SMS via the Twilio web service:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;send_sms&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">runner_type</span><span class="p p-Indicator">:</span> <span class="s">&quot;python-script&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;This</span><span class="nv"> </span><span class="s">sends</span><span class="nv"> </span><span class="s">an</span><span class="nv"> </span><span class="s">SMS</span><span class="nv"> </span><span class="s">using</span><span class="nv"> </span><span class="s">twilio.&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="l l-Scalar l-Scalar-Plain">entry_point</span><span class="p p-Indicator">:</span> <span class="s">&quot;send_sms.py&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">parameters</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">from_number</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;string&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;Your</span><span class="nv"> </span><span class="s">twilio</span><span class="nv"> </span><span class="s">&#39;from&#39;</span><span class="nv"> </span><span class="s">number</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">E.164</span><span class="nv"> </span><span class="s">format.</span><span class="nv"> </span><span class="s">Example</span><span class="nv"> </span><span class="s">+14151234567.&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">position</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class="l l-Scalar l-Scalar-Plain">to_number</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;string&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;Recipient</span><span class="nv"> </span><span class="s">number</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">E.164</span><span class="nv"> </span><span class="s">format.</span><span class="nv"> </span><span class="s">Example</span><span class="nv"> </span><span class="s">+14151234567.&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">position</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
        <span class="l l-Scalar l-Scalar-Plain">secret</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="l l-Scalar l-Scalar-Plain">body</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;string&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;Body</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">message.&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">position</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
        <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="s">&quot;Hello</span><span class="nv"> </span><span class="s">{%</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">system.user</span><span class="nv"> </span><span class="s">%}</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">st2kv.system.user</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">{%</span><span class="nv"> </span><span class="s">else</span><span class="nv"> </span><span class="s">%}</span><span class="nv"> </span><span class="s">dude</span><span class="nv"> </span><span class="s">{%</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}!&quot;</span>
</pre></div>
</div>
<p>This action is using a Python runner (<code class="docutils literal notranslate"><span class="pre">python-script</span></code>). The class that implements a <code class="docutils literal notranslate"><span class="pre">run</span></code>
method is contained in a file called <code class="docutils literal notranslate"><span class="pre">send_sms.py</span></code> which is located in the same directory as the
metadata file. The action takes three parameters (<code class="docutils literal notranslate"><span class="pre">from_number</span></code>, <code class="docutils literal notranslate"><span class="pre">to_number</span></code>, <code class="docutils literal notranslate"><span class="pre">body</span></code>).</p>
<p>In the example above, the <code class="docutils literal notranslate"><span class="pre">to_number</span></code> parameter contains the attribute <code class="docutils literal notranslate"><span class="pre">secret</span></code> with value:
<code class="docutils literal notranslate"><span class="pre">true</span></code>. If an attribute is marked as a secret, the value of that attribute will be masked in the
StackStorm service logs.</p>
</div>
<div class="section" id="parameters-in-actions">
<h3>Parameters in Actions<a class="headerlink" href="#parameters-in-actions" title="Permalink to this headline">¶</a></h3>
<p>In the previous example, you probably noticed how you can access parameters from the key-value
store by using the <code class="docutils literal notranslate"><span class="pre">st2kv.system</span></code> prefix in the template. You can also get access to variables
from the context of the execution. For example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">parameters</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">user</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;string&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;User</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">this</span><span class="nv"> </span><span class="s">action.&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="s">&quot;{{action_context.api_user}}&quot;</span>
</pre></div>
</div>
<p>The prefix <code class="docutils literal notranslate"><span class="pre">action_context</span></code> is used to refer to variables in action context. Depending on how
the execution is executed and nature of action (simple vs workflow), variables in
<code class="docutils literal notranslate"><span class="pre">action_context</span></code> change.</p>
<p>A simple execution via the API will only contain the variables <code class="docutils literal notranslate"><span class="pre">user</span></code> and <code class="docutils literal notranslate"><span class="pre">pack</span></code>. An execution
triggered  via ChatOps will contain variables such as <code class="docutils literal notranslate"><span class="pre">api_user</span></code>, <code class="docutils literal notranslate"><span class="pre">user</span></code>, <code class="docutils literal notranslate"><span class="pre">pack</span></code>, and
<code class="docutils literal notranslate"><span class="pre">source_channel</span></code>. In the ChatOps case, <code class="docutils literal notranslate"><span class="pre">api_user</span></code> is the user who entered the ChatOps command
from the Chat client and <code class="docutils literal notranslate"><span class="pre">user</span></code> is the StackStorm user configured in hubot. <code class="docutils literal notranslate"><span class="pre">source_channel</span></code> is the
channel in which the ChatOps command was entered.</p>
<p>In addition to <code class="docutils literal notranslate"><span class="pre">action_context</span></code> you can also access <code class="docutils literal notranslate"><span class="pre">config_context</span></code> which contains the
key-value contents of your <a class="reference internal" href="reference/pack_configs.html"><span class="doc">pack configuration</span></a>. The example below
shows how you could use this for the default value for a parameter:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;send_sms&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">runner_type</span><span class="p p-Indicator">:</span> <span class="s">&quot;python-script&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;This</span><span class="nv"> </span><span class="s">sends</span><span class="nv"> </span><span class="s">an</span><span class="nv"> </span><span class="s">SMS</span><span class="nv"> </span><span class="s">using</span><span class="nv"> </span><span class="s">twilio.&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="l l-Scalar l-Scalar-Plain">entry_point</span><span class="p p-Indicator">:</span> <span class="s">&quot;send_sms.py&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">parameters</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">from_number</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;string&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;Your</span><span class="nv"> </span><span class="s">twilio</span><span class="nv"> </span><span class="s">&#39;from&#39;</span><span class="nv"> </span><span class="s">number</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">E.164</span><span class="nv"> </span><span class="s">format.</span><span class="nv"> </span><span class="s">Example</span><span class="nv"> </span><span class="s">+14151234567.&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
        <span class="l l-Scalar l-Scalar-Plain">position</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
        <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="s">&quot;{{config_context.from_number}}&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">to_number</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;string&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;Recipient</span><span class="nv"> </span><span class="s">number</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">E.164</span><span class="nv"> </span><span class="s">format.</span><span class="nv"> </span><span class="s">Example</span><span class="nv"> </span><span class="s">+14151234567.&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">position</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
        <span class="l l-Scalar l-Scalar-Plain">secret</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="l l-Scalar l-Scalar-Plain">body</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;string&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;Body</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">message.&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">position</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
        <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="s">&quot;Hello</span><span class="nv"> </span><span class="s">{%</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">system.user</span><span class="nv"> </span><span class="s">%}</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">st2kv.system.user</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">{%</span><span class="nv"> </span><span class="s">else</span><span class="nv"> </span><span class="s">%}</span><span class="nv"> </span><span class="s">dude</span><span class="nv"> </span><span class="s">{%</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}!&quot;</span>
</pre></div>
</div>
<p>In ActionChains and workflows (see <a class="reference internal" href="workflows.html"><span class="doc">Workflow</span></a>), every task in the workflow can
access the parent’s <code class="docutils literal notranslate"><span class="pre">execution_id</span></code>. For example, a task in an action chain is shown below:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">...</span>
<span class="p p-Indicator">-</span>
  <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;c2&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">ref</span><span class="p p-Indicator">:</span> <span class="s">&quot;core.local&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">parameters</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">cmd</span><span class="p p-Indicator">:</span> <span class="s">&quot;echo</span><span class="nv"> </span><span class="s">\&quot;c2:</span><span class="nv"> </span><span class="s">parent</span><span class="nv"> </span><span class="s">exec</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">{{action_context.parent.execution_id}}.\&quot;&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">on-success</span><span class="p p-Indicator">:</span> <span class="s">&quot;c3&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">on-failure</span><span class="p p-Indicator">:</span> <span class="s">&quot;c4&quot;</span>
<span class="nn">...</span>
</pre></div>
</div>
</div>
<div class="section" id="action-registration">
<h3>Action Registration<a class="headerlink" href="#action-registration" title="Permalink to this headline">¶</a></h3>
<p>To register a new action:</p>
<ol class="arabic simple">
<li>Place it into the content location.</li>
<li>Tell the system that the action is available.</li>
</ol>
<p>The actions are grouped in <a class="reference internal" href="packs.html"><span class="doc">packs</span></a> and located at <code class="docutils literal notranslate"><span class="pre">/opt/stackstorm/packs</span></code></p>
<p>For hacking one-off actions, the convention is to use the <code class="docutils literal notranslate"><span class="pre">default</span></code> pack - just
create your action in <code class="docutils literal notranslate"><span class="pre">/opt/stackstorm/packs/default/actions</span></code>. Once you have tested it out, you
should move it to a dedicated pack.</p>
<p>Register an individual action by calling <code class="docutils literal notranslate"><span class="pre">st2</span> <span class="pre">action</span> <span class="pre">create</span> <span class="pre">my_action_metadata.yaml</span></code>.
To reload all actions, use <code class="docutils literal notranslate"><span class="pre">st2ctl</span> <span class="pre">reload</span> <span class="pre">--register-actions</span></code></p>
</div>
</div>
<div class="section" id="built-in-parameters">
<h2>Built-in Parameters<a class="headerlink" href="#built-in-parameters" title="Permalink to this headline">¶</a></h2>
<p>When configuring the metadata, there are several built-in parameters that can be used and
overwritten to change the default functionality of the various runners:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">args</span></code> - (<code class="docutils literal notranslate"><span class="pre">local-shell-script</span></code>, <code class="docutils literal notranslate"><span class="pre">remote-shell-script</span></code>) By default, StackStorm will assemble
arguments based on whether a user defines named or positional arguments. Adjusts the format of
arguments passed to <code class="docutils literal notranslate"><span class="pre">cmd</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">cmd</span></code>  - (<code class="docutils literal notranslate"><span class="pre">local-shell-script</span></code>, <code class="docutils literal notranslate"><span class="pre">remote-shell-script</span></code>) Configure the command to be run
on the target system.</li>
<li><code class="docutils literal notranslate"><span class="pre">cwd</span></code>  - (<code class="docutils literal notranslate"><span class="pre">local-shell-script</span></code>, <code class="docutils literal notranslate"><span class="pre">remote-shell-script</span></code>) Configure the directory where
remote commands will be executed from.</li>
<li><code class="docutils literal notranslate"><span class="pre">env</span></code>  - (<code class="docutils literal notranslate"><span class="pre">local-shell-script</span></code>, <code class="docutils literal notranslate"><span class="pre">local-shell-script-script</span></code>, <code class="docutils literal notranslate"><span class="pre">remote-shell-script</span></code>,
<code class="docutils literal notranslate"><span class="pre">remote-shell-script-script</span></code>, <code class="docutils literal notranslate"><span class="pre">python-script</span></code>) Environment variables which will be
available to the executed command/script.</li>
<li><code class="docutils literal notranslate"><span class="pre">dir</span></code>  - (<code class="docutils literal notranslate"><span class="pre">local-shell-script</span></code>, <code class="docutils literal notranslate"><span class="pre">remote-shell-script</span></code>) Configure the directory where
scripts are copied from a pack to the target machine prior to execution.
Defaults to <code class="docutils literal notranslate"><span class="pre">/tmp</span></code>.</li>
</ul>
</div>
<div class="section" id="overriding-runner-parameters">
<h2>Overriding Runner Parameters<a class="headerlink" href="#overriding-runner-parameters" title="Permalink to this headline">¶</a></h2>
<p>Parameters of runners can be overridden. Sometimes it’s necessary to customize and simplify an
action. Take the following <code class="docutils literal notranslate"><span class="pre">linux.rsync</span></code> action that is included in the linux pack.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">linux.rsync</span></code> action overrides the <code class="docutils literal notranslate"><span class="pre">cmd</span></code> parameter in the <code class="docutils literal notranslate"><span class="pre">remote-shell-cmd</span></code> runner with
the <code class="docutils literal notranslate"><span class="pre">rsync</span></code> command with appropriate args passed from the action parameters defined for the
<code class="docutils literal notranslate"><span class="pre">linux.rsync</span></code> action:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
    <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&#39;rsync&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">runner_type</span><span class="p p-Indicator">:</span> <span class="s">&#39;remote-shell-cmd&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&#39;Copy</span><span class="nv"> </span><span class="s">file(s)</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">one</span><span class="nv"> </span><span class="s">place</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">another</span><span class="nv"> </span><span class="s">w/</span><span class="nv"> </span><span class="s">rsync&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="l l-Scalar l-Scalar-Plain">entry_point</span><span class="p p-Indicator">:</span> <span class="s">&#39;&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">parameters</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">source</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&#39;string&#39;</span>
            <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&#39;List</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">files/directories</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">be</span><span class="nv"> </span><span class="s">copied&#39;</span>
            <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">dest_server</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&#39;string&#39;</span>
            <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;Destination</span><span class="nv"> </span><span class="s">server</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">rsync&#39;d</span><span class="nv"> </span><span class="s">files&quot;</span>
            <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">destination</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&#39;string&#39;</span>
            <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&#39;Destination</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">files/directories</span><span class="nv"> </span><span class="s">on</span><span class="nv"> </span><span class="s">target</span><span class="nv"> </span><span class="s">server&#39;</span>
            <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">cmd</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">immutable</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
            <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="s">&#39;rsync</span><span class="nv"> </span><span class="s">{{args}}</span><span class="nv"> </span><span class="s">{{source}}</span><span class="nv"> </span><span class="s">{{dest_server}}:{{destination}}&#39;</span>
        <span class="l l-Scalar l-Scalar-Plain">connect_timeout</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&#39;integer&#39;</span>
            <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&#39;SSH</span><span class="nv"> </span><span class="s">connect</span><span class="nv"> </span><span class="s">timeout</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">seconds&#39;</span>
            <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">30</span>
        <span class="l l-Scalar l-Scalar-Plain">args</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&#39;Command</span><span class="nv"> </span><span class="s">line</span><span class="nv"> </span><span class="s">arguments</span><span class="nv"> </span><span class="s">passed</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">rysnc&#39;</span>
            <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="s">&#39;-avz</span><span class="nv"> </span><span class="s">-e</span><span class="nv"> </span><span class="s">&quot;ssh</span><span class="nv"> </span><span class="s">-o</span><span class="nv"> </span><span class="s">ConnectTimeout={{connect_timeout}}&quot;&#39;</span>
</pre></div>
</div>
<p>Not all attributes for runner parameters can be overridden. A list of attributes which can be
overriden is included below:</p>
<ul class="simple">
<li>default</li>
<li>description</li>
<li>enum</li>
<li>immutable</li>
<li>required</li>
</ul>
<p>Overriding attributes such as <code class="docutils literal notranslate"><span class="pre">type</span></code> and <code class="docutils literal notranslate"><span class="pre">position</span></code> are not allowed because overriding them can
potentially break the action since the runner will not be able to consume the type of value being
passed (e.g. runner parameter is expecting an integer but a string is passed).</p>
</div>
<div class="section" id="environment-variables-available-to-actions">
<h2>Environment Variables Available to Actions<a class="headerlink" href="#environment-variables-available-to-actions" title="Permalink to this headline">¶</a></h2>
<p>By default, local, remote and Python runners make the following environment variables available
to the actions:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">ST2_ACTION_PACK_NAME</span></code> - Name of the pack to which the currently executed action belongs to.</li>
<li><code class="docutils literal notranslate"><span class="pre">ST2_ACTION_EXECUTION_ID</span></code> - Execution ID of the action being currently executed.</li>
<li><code class="docutils literal notranslate"><span class="pre">ST2_ACTION_API_URL</span></code> - Full URL to the public API endpoint.</li>
<li><code class="docutils literal notranslate"><span class="pre">ST2_ACTION_AUTH_TOKEN</span></code> - Auth token which is available to the action until it completes.
When the action completes, the token gets revoked.</li>
</ul>
<p>Here is an example of how you can use these environment variables inside a local shell script
action.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="c1"># Retrieve a list of actions by hitting the API using cURL and the information provided</span>
<span class="c1"># via environment variables</span>

<span class="nv">RESULT</span><span class="o">=</span><span class="k">$(</span>curl -H <span class="s2">&quot;X-Auth-Token: </span><span class="si">${</span><span class="nv">ST2_ACTION_AUTH_TOKEN</span><span class="si">}</span><span class="s2">&quot;</span> <span class="si">${</span><span class="nv">ST2_ACTION_API_URL</span><span class="si">}</span>/actions<span class="k">)</span>
<span class="nb">echo</span> <span class="si">${</span><span class="nv">RESULT</span><span class="si">}</span>
</pre></div>
</div>
</div>
<div class="section" id="converting-existing-scripts-into-actions">
<span id="ref-actions-converting-scripts"></span><h2>Converting Existing Scripts into Actions<a class="headerlink" href="#converting-existing-scripts-into-actions" title="Permalink to this headline">¶</a></h2>
<p>If you have an existing standalone script written in an arbitrary programming or scripting
language and you want to convert it to an action, the process is very simple.</p>
<p>Follow these steps:</p>
<div class="section" id="make-sure-the-script-conforms-to-conventions">
<h3>1. Make sure the script conforms to conventions<a class="headerlink" href="#make-sure-the-script-conforms-to-conventions" title="Permalink to this headline">¶</a></h3>
<p>You should make sure that the script exits with a zero status code on success and non-zero on
error. This is important since the exit code is used by StackStorm to determine if the script has
finished successfully.</p>
</div>
<div class="section" id="create-a-metadata-file">
<h3>2. Create a metadata file<a class="headerlink" href="#create-a-metadata-file" title="Permalink to this headline">¶</a></h3>
<p>You need to create a metadata file which describes the script name, description, entry point,
which runner to use and script parameters (if any).</p>
<p>When converting an existing script, you will want to use either the <code class="docutils literal notranslate"><span class="pre">local-shell-script</span></code>
or <code class="docutils literal notranslate"><span class="pre">remote-shell-script</span></code> runner.</p>
</div>
<div class="section" id="update-argument-parsing-in-the-script">
<h3>2. Update argument parsing in the script<a class="headerlink" href="#update-argument-parsing-in-the-script" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If your script doesn’t take any arguments, you can skip this step.</p>
</div>
<p>Local and remote script runners recognize two types of parameters:</p>
<ol class="arabic simple">
<li><code class="docutils literal notranslate"><span class="pre">named</span></code> - those parameters do not include the <code class="docutils literal notranslate"><span class="pre">position</span></code> attribute.</li>
<li><code class="docutils literal notranslate"><span class="pre">positional</span></code> - those parameters include the <code class="docutils literal notranslate"><span class="pre">position</span></code> attribute.</li>
</ol>
<p>All parameters are passed to the script via command-line arguments.</p>
<p>Named argument are passed to the script in the following format:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>script.sh --param1<span class="o">=</span>value --param2<span class="o">=</span>value --param3<span class="o">=</span>value
</pre></div>
</div>
<p>By default, each parameter is prefixed with two dashes (<code class="docutils literal notranslate"><span class="pre">--</span></code>). If you want to use a single dash
(<code class="docutils literal notranslate"><span class="pre">-</span></code>), some other prefix or no prefix at all, you can configure that using the <code class="docutils literal notranslate"><span class="pre">kwarg_op</span></code>
parameter in the metadata file.</p>
<p>For example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;my_script&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">runner_type</span><span class="p p-Indicator">:</span> <span class="s">&quot;remote-shell-script&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;Script</span><span class="nv"> </span><span class="s">which</span><span class="nv"> </span><span class="s">prints</span><span class="nv"> </span><span class="s">arguments</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">stdout.&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="l l-Scalar l-Scalar-Plain">entry_point</span><span class="p p-Indicator">:</span> <span class="s">&quot;script.sh&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">parameters</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">key1</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;string&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="l l-Scalar l-Scalar-Plain">key2</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;string&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="l l-Scalar l-Scalar-Plain">key3</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;string&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="l l-Scalar l-Scalar-Plain">kwarg_op</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;string&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">immutable</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="s">&quot;-&quot;</span>
</pre></div>
</div>
<p>In this case, arguments are passed to the script in the following format:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>script.sh -key1<span class="o">=</span>value1 -key2<span class="o">=</span>value2 -key3<span class="o">=</span>value3
</pre></div>
</div>
<p>Positional arguments are passed to the script ordered by the <code class="docutils literal notranslate"><span class="pre">position</span></code> value in the following
format:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>script.sh value2 value1 value3
</pre></div>
</div>
<p id="ref-positional-parameters-serialization">If your script only uses positional arguments (which is often the case for existing scripts), you
simply need to declare parameters with the correct value for the <code class="docutils literal notranslate"><span class="pre">position</span></code> attribute in the metadata file. Positional arguments are serialized based on the simple rules described below:</p>
<ol class="arabic simple">
<li><code class="docutils literal notranslate"><span class="pre">string</span></code>, <code class="docutils literal notranslate"><span class="pre">integer</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code> - Serialized as a string.</li>
<li><code class="docutils literal notranslate"><span class="pre">boolean</span></code> - Serialized as a string <code class="docutils literal notranslate"><span class="pre">1</span></code> (true) or <code class="docutils literal notranslate"><span class="pre">0</span></code> (false).</li>
<li><code class="docutils literal notranslate"><span class="pre">array</span></code> - Serialized as a comma delimited string (e.g. <code class="docutils literal notranslate"><span class="pre">foo,bar,baz</span></code>).</li>
<li><code class="docutils literal notranslate"><span class="pre">object</span></code> - Serialized as JSON.</li>
</ol>
<p>Using this simple serialization format allows users to easily utilize those values in their
scripts by using standard Bash functionality (<code class="docutils literal notranslate"><span class="pre">-z</span></code> for check if a value is provided, <code class="docutils literal notranslate"><span class="pre">-eq</span></code> for
comparison to 1/0 and <code class="docutils literal notranslate"><span class="pre">IFS</span></code> for splitting a string into an array). For working with objects, you
can use a tool such as <a class="reference external" href="https://stedolan.github.io/jq/">jq</a>.</p>
<p>If no value is provided for a particular positional parameter, StackStorm will pass an empty string
<code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> as a value for that parameter to the script.</p>
<p>For example, if a second positional parameter is optional and user provides no value, the script
will be called like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>script.sh value1 <span class="s2">&quot;&quot;</span> value3
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">immutable</span></code> value defines whether the default value of a parameter can be overridden. This
is particularly important if you expose commands via ChatOps and do not like security related
parameters to be manipulated by user input.</p>
</div>
<div class="section" id="example-1-existing-bash-script-with-positional-arguments">
<h3>Example 1 - existing Bash script with positional arguments<a class="headerlink" href="#example-1-existing-bash-script-with-positional-arguments" title="Permalink to this headline">¶</a></h3>
<p>Let’s say we have a simple Bash script named <code class="docutils literal notranslate"><span class="pre">send_to_syslog.sh</span></code> which writes the message
provided via the command line argument to syslog.</p>
<p>The script takes two arguments:</p>
<ol class="arabic simple">
<li>The address of the syslog server</li>
<li>The message to write</li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="nv">SERVER</span><span class="o">=</span><span class="nv">$1</span>
<span class="nv">MESSAGE</span><span class="o">=</span><span class="nv">$2</span>
logger -n <span class="si">${</span><span class="nv">SERVER</span><span class="si">}</span> <span class="si">${</span><span class="nv">MESSAGE</span><span class="si">}</span>
</pre></div>
</div>
<p>Since this script is using positional arguments, you only need to define them in the metadata file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;send_to_syslog.log&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">runner_type</span><span class="p p-Indicator">:</span> <span class="s">&quot;remote-shell-script&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;Send</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">message</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">provided</span><span class="nv"> </span><span class="s">syslog</span><span class="nv"> </span><span class="s">server.&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="l l-Scalar l-Scalar-Plain">entry_point</span><span class="p p-Indicator">:</span> <span class="s">&quot;send_to_syslog.sh&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">parameters</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">server</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;string&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;Address</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">syslog</span><span class="nv"> </span><span class="s">server&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">position</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
    <span class="l l-Scalar l-Scalar-Plain">message</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;string&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;Message</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">write&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">position</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
</pre></div>
</div>
<p>As you can see above, we declare two parameters - <code class="docutils literal notranslate"><span class="pre">server</span></code> and <code class="docutils literal notranslate"><span class="pre">message</span></code>. Both of them declare
a <code class="docutils literal notranslate"><span class="pre">position</span></code> attribute (0 for server and 1 for message), which means they will be passed to the
action script as positional arguments, so your script doesn’t require any changes.</p>
</div>
</div>
<div class="section" id="writing-custom-python-actions">
<h2>Writing Custom Python Actions<a class="headerlink" href="#writing-custom-python-actions" title="Permalink to this headline">¶</a></h2>
<p>In the simplest form, a Python action is a module which exposes a class which inherits from
<code class="xref py py-class docutils literal notranslate"><span class="pre">st2common.runners.base_action.Action</span></code> and implements a <code class="docutils literal notranslate"><span class="pre">run</span></code> method.</p>
<div class="section" id="sample-python-action">
<h3>Sample Python Action<a class="headerlink" href="#sample-python-action" title="Permalink to this headline">¶</a></h3>
<p>Metadata file (<code class="docutils literal notranslate"><span class="pre">my_echo_action.yaml</span></code>):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;echo_action&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">runner_type</span><span class="p p-Indicator">:</span> <span class="s">&quot;python-script&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;Print</span><span class="nv"> </span><span class="s">message</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">standard</span><span class="nv"> </span><span class="s">output.&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">enabled</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="l l-Scalar l-Scalar-Plain">entry_point</span><span class="p p-Indicator">:</span> <span class="s">&quot;my_echo_action.py&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">parameters</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">message</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;string&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;Message</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">print.&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">position</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
</pre></div>
</div>
<p>Action script file (<code class="docutils literal notranslate"><span class="pre">my_echo_action.py</span></code>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">st2common.runners.base_action</span> <span class="kn">import</span> <span class="n">Action</span>

<span class="k">class</span> <span class="nc">MyEchoAction</span><span class="p">(</span><span class="n">Action</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">message</span> <span class="o">==</span> <span class="s1">&#39;working&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</pre></div>
</div>
<p>This Python action prints text provided via the <code class="docutils literal notranslate"><span class="pre">message</span></code> parameter to the standard output. As
you can see, user-supplied action parameters are passed to the <code class="docutils literal notranslate"><span class="pre">run</span></code> method as keyword arguments.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">run</span></code> method finishes without exceptions, the execution is successful, and the value
returned by the method (any value: boolean, string, list, dict, etc.) is considered its result.
Raising an exception will report the execution as failed.</p>
<p>Another way to specify the status of an execution is returning a tuple with two items: the first
item is a boolean indicating status, the second item is the result itself.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">False</span></code> will result in a successful execution with the result being
<code class="docutils literal notranslate"><span class="pre">False</span></code>, and <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">(False,</span> <span class="pre">&quot;Failed!&quot;)</span></code> is a failed execution with <code class="docutils literal notranslate"><span class="pre">&quot;Failed!&quot;</span></code> as its
result.</p>
<p>In the example above, if the <code class="docutils literal notranslate"><span class="pre">message</span></code> parameter passed to the action is <code class="docutils literal notranslate"><span class="pre">working</span></code>, the action
will be considered as succeeded (first flag in the result indicating action status is <code class="docutils literal notranslate"><span class="pre">True</span></code>).
If another message is passed in, action will be considered as failed (first flag in the result
tuple indicating action status is <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
<p>For a more complex example, please refer to the <a class="reference external" href="https://github.com/StackStorm-Exchange/libcloud/tree/master/actions">actions in the Libcloud pack in
StackStorm Exchange</a>.</p>
</div>
<div class="section" id="configuration-file">
<h3>Configuration File<a class="headerlink" href="#configuration-file" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The configuration file should be used to store “static” configuration options which don’t
change between the action runs (e.g. service credentials, different constants, etc.).</p>
<p class="last">For options/parameters which are user defined or change often, you should use action
parameters which are defined in the metadata file.</p>
</div>
<p>Python actions can store arbitrary configuration in the configuration file which is global to the whole pack. The configuration is stored in a file named <code class="docutils literal notranslate"><span class="pre">&lt;pack_name&gt;.yaml</span></code>, in the
<code class="docutils literal notranslate"><span class="pre">/opt/stackstorm/configs/</span></code> directory.</p>
<p>The configuration file format is YAML. Configuration is automatically parsed and passed to the action class constructor via the <code class="docutils literal notranslate"><span class="pre">config</span></code> argument.  See the
<a class="reference internal" href="reference/pack_configs.html"><span class="doc">pack configuration doc</span></a> for more details.</p>
</div>
<div class="section" id="logging">
<h3>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h3>
<p>All logging inside the action should be performed via the logger which is specific to this action
and available via the <code class="docutils literal notranslate"><span class="pre">self.logger</span></code> class attribute.</p>
<p>This logger is a standard Python logger from the <code class="docutils literal notranslate"><span class="pre">logging</span></code> module so all the logger methods work
as expected (e.g. <code class="docutils literal notranslate"><span class="pre">logger.debug</span></code>, <code class="docutils literal notranslate"><span class="pre">logger.info</span></code>, etc).</p>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="n">success</span> <span class="o">=</span> <span class="n">call_some_method</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Action successfully completed&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Action failed...&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="action-service">
<h3>Action Service<a class="headerlink" href="#action-service" title="Permalink to this headline">¶</a></h3>
<p>Similar to sensors, <code class="docutils literal notranslate"><span class="pre">action_service</span></code> is available on each action instance after instantiation.</p>
<p>Action service provides different services to the action via public methods. Right now it supports
datastore management methods. This allows actions to utilize the datastore to store arbitrary data
between executions.</p>
<p>The action service provides the same datastore management methods as the ones available on the
sensor service. You can find more details in the
<a class="reference internal" href="sensors.html#ref-sensors-datastore-management-operations"><span class="std std-ref">sensor datastore management documentation</span></a>.</p>
<p>Example storing a dict as JSON:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;somedata&#39;</span><span class="p">:</span> <span class="s1">&#39;foobar&#39;</span><span class="p">}</span>

  <span class="c1"># Add a value to the datastore</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">action_service</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;cache&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

  <span class="c1"># Retrieve a value</span>
  <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_service</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s1">&#39;cache&#39;</span><span class="p">)</span>
  <span class="n">retrieved_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

  <span class="c1"># Retrieve an encrypted value</span>
  <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_service</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s1">&#39;ma_password&#39;</span><span class="p">,</span> <span class="n">decrypt</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
  <span class="n">retrieved_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

  <span class="c1"># Delete a value</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">action_service</span><span class="o">.</span><span class="n">delete_value</span><span class="p">(</span><span class="s1">&#39;cache&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="sharing-code-between-python-sensors-and-actions">
<h3>Sharing code between Python Sensors and Actions<a class="headerlink" href="#sharing-code-between-python-sensors-and-actions" title="Permalink to this headline">¶</a></h3>
<p>Refer to <a class="reference internal" href="reference/sharing_code_sensors_actions.html#ref-shared-libs-python-sensors-actions"><span class="std std-ref">documentation</span></a> on sharing common code
between python actions and sensors.</p>
</div>
</div>
<div class="section" id="pre-defined-actions">
<h2>Pre-defined Actions<a class="headerlink" href="#pre-defined-actions" title="Permalink to this headline">¶</a></h2>
<p>There are several predefined actions that come out of the box with StackStorm. These are in the <code class="docutils literal notranslate"><span class="pre">core</span></code>
pack:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">core.local</span></code> : This action allows execution of arbitrary *nix/shell commands locally. You can
execute this command via the CLI using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>st2 run core.local <span class="nv">cmd</span><span class="o">=</span><span class="s1">&#39;ls -l&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">core.remote</span></code> : This action allows execution of arbitrary *nix/shell commands on a set of
boxes. Execute this command via the CLI with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>st2 run core.remote <span class="nv">cmd</span><span class="o">=</span><span class="s1">&#39;ls -l&#39;</span> <span class="nv">hosts</span><span class="o">=</span><span class="s1">&#39;host1,host2&#39;</span> <span class="nv">username</span><span class="o">=</span><span class="s1">&#39;user1&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">core.http</span></code> : This action allows execution of http requests. Think <code class="docutils literal notranslate"><span class="pre">curl</span></code> executed from the
StackStorm box:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>st2 run core.http <span class="nv">url</span><span class="o">=</span><span class="s2">&quot;http://httpbin.org/get&quot;</span> <span class="nv">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span>
</pre></div>
</div>
<p>Similar to <code class="docutils literal notranslate"><span class="pre">curl</span></code>, this action supports basic authentication when provided a username and
password:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>st2 run core.http <span class="nv">url</span><span class="o">=</span><span class="s2">&quot;http://httpbin.org/get&quot;</span> <span class="nv">method</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span> <span class="nv">username</span><span class="o">=</span>user1 <span class="nv">password</span><span class="o">=</span>pass1
</pre></div>
</div>
</li>
</ul>
<p>To see all actions in the <code class="docutils literal notranslate"><span class="pre">core</span></code> pack:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>st2 action list --pack<span class="o">=</span>core
</pre></div>
</div>
<p class="rubric">What’s Next?</p>
<ul class="simple">
<li>Explore packs and actions contributed by StackStorm developers and community in the <a class="reference external" href="https://exchange.stackstorm.org">StackStorm Exchange</a>.</li>
<li>Check out <a class="reference external" href="https://stackstorm.com/category/tutorials/">tutorials on stackstorm.com</a> on creating actions, and other practical examples of automating with StackStorm.</li>
</ul>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="sensors.html" class="btn btn-neutral float-right" title="Sensors and Triggers">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="start.html" class="btn btn-neutral" title="Quick Start"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014 - 2018, StackStorm.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  
  <div id="versions"></div>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.8dev',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  

  <script type="text/javascript" src="/_static/js/versions.js"></script> 

</body>
</html>