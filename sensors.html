

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-site-verification" content="ovwnX0ej2kps4UuJ9NOzNjJcLOQD8JPDLNhe-hMYTMk" />
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NKZBMHZ');</script>
  <!-- End Google Tag Manager -->
  
  <title>Sensors and Triggers &mdash; StackStorm 2.7dev documentation</title>
  

  <link rel="shortcut icon" href="_static/favicon.ico?v4"/>
  
  
    <link rel="canonical" href="https://docs.stackstorm.com/sensors.html"/>
  

  
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,300italic,400italic,600,600italic,700,700italic|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="StackStorm 2.7dev documentation" href="index.html"/>
        <link rel="next" title="Rules" href="rules.html"/>
        <link rel="prev" title="Actions" href="actions.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NKZBMHZ"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html">
            <svg class="logo"
                xmlns="http://www.w3.org/2000/svg"xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"
                viewBox="0 0 680 120"
                xml:space="preserve">
              <polygon points="116,0 56.8,0 116,48.6"/>
              <polygon points="0.7,120 64.7,120 0.7,69.9"/>
              <path d="M450.756 55.793l-8.824-2.206c-4.584-1.161-7.865-2.744-9.85-4.746c-1.982-1.999-2.977-4.727-2.977-8.181 c0-4.549 1.523-8.071 4.568-10.569c3.045-2.496 7.336-3.744 12.875-3.744c5.881 0 10.4 1.5 13.7 4.4 c3.248 2.9 4.9 7.1 5 12.44h7.031c-0.104-7.25-2.385-12.892-6.85-16.929c-4.465-4.034-10.664-6.053-18.596-6.053 c-7.49 0-13.475 1.846-17.955 5.54c-4.48 3.693-6.721 8.603-6.721 14.723c0 5.5 1.5 9.8 4.4 12.9 c2.957 3.1 8.3 5.6 16 7.567l7.184 1.796c7.047 1.8 11.8 3.8 14.1 6.104c2.361 2.3 3.5 5.5 3.5 9.8 c0 4.652-1.686 8.303-5.053 10.954c-3.369 2.649-7.996 3.975-13.879 3.975c-6.701 0-11.9-1.641-15.594-4.924 s-5.574-7.9-5.643-13.851h-6.926v0.512c0 7.9 2.4 13.9 7.3 18.136c4.855 4.2 11.8 6.3 20.8 6.3 c8.035 0 14.371-1.948 19.006-5.848c4.635-3.897 6.951-9.233 6.951-16.004c0-5.883-1.76-10.499-5.283-13.853 C465.598 60.8 459.5 58 450.8 55.8"/>
              <path d="M494.566 27.527h-6.311v15.648h-7.438v5.13h7.438v39.755c0 4.2 0.7 7.1 1.9 8.6 s3.523 2.4 6.7 2.386c1.129 0 2.328-0.096 3.592-0.281c1.268-0.189 2.666-0.489 4.207-0.899l-0.051-5.027 c-1.744 0.377-3.027 0.625-3.85 0.745c-0.82 0.119-1.555 0.179-2.203 0.179c-1.508 0-2.549-0.375-3.131-1.13 c-0.582-0.751-0.871-2.29-0.871-4.616V48.305h10.105v-5.13h-10.105V27.527z"/>
              <path d="M536.99 41.79c-7.934 0-14.082 2.505-18.443 7.514c-4.359 5.01-6.541 12.081-6.541 21.2 c0 9.1 2.2 16.1 6.5 21.11c4.361 5 10.5 7.5 18.4 7.465c8.002 0 14.189-2.496 18.57-7.491 c4.377-4.992 6.566-12.02 6.566-21.084c0-9.132-2.199-16.203-6.592-21.213C551.141 44.3 545 41.8 537 41.8 M550.686 87.6 c-3.215 4.001-7.779 6.001-13.695 6.001c-5.848 0-10.389-2.016-13.619-6.052c-3.234-4.035-4.85-9.713-4.85-17.032 c0-7.352 1.615-13.047 4.85-17.083c3.23-4.035 7.771-6.053 13.619-6.053c5.916 0 10.5 2 13.7 6 c3.217 4 4.8 9.7 4.8 17.109S553.902 83.6 550.7 87.6"/>
              <path d="M586.008 44.508c-2.789 1.812-4.969 4.549-6.541 8.207v-9.541h-6.105v54.531h6.514V67.644 c0-6.395 1.359-11.2 4.078-14.414c2.719-3.215 6.797-4.823 12.234-4.823h0.822V41.79h-0.717 C592.221 41.8 588.8 42.7 586 44.5"/>
              <path d="M675.166 46.227c-2.926-2.957-7.346-4.437-13.262-4.437c-3.898 0-7.346 0.915-10.338 2.7 s-5.395 4.489-7.207 7.977c-0.891-3.42-2.68-6.062-5.377-7.925c-2.699-1.864-6.08-2.796-10.143-2.796 c-3.791 0-7.162 0.897-10.113 2.693c-2.957 1.795-5.355 4.369-7.199 7.72v-9.029h-5.9v54.532h6.311V64.001 c0-4.925 1.477-8.907 4.428-11.954c2.955-3.042 6.82-4.566 11.6-4.566c3.893 0 6.8 1.1 8.7 3.3 c1.879 2.2 2.8 5.5 2.8 10.054v36.886h6.309V63.54c0-4.821 1.453-8.723 4.361-11.696c2.906-2.976 6.771-4.463 11.592-4.463 c4.07 0 7 1 8.8 2.976c1.775 2 2.7 5.3 2.7 9.85v37.5h6.412V59.692 C679.551 53.7 678.1 49.2 675.2 46.2"/>
              <path d="M118.944 67.886c-2.638-4.731-7.001-9.521-13.085-14.393L41.482 0.8 c-4.365 0.046-7.895 0.271-10.581 0.677c-2.734 0.466-5.502 1.227-8.287 2.282c-7.151 2.9-12.714 7.208-16.671 12.9 C1.991 22.4 0 29 0 36.76c0 2.8 0.4 5.8 1.2 8.973c0.762 3.2 1.8 6.1 3.2 8.8 c1.728 3.2 4.6 7 8.7 11.351c4.111 4.5 9.7 9.6 16.7 15.438c7.149 6.1 14.6 11.9 22.2 17.6 c4.731 3.4 8.8 6.4 12.3 8.825c3.447 2.4 9.3 6.5 17.5 12.247c3.098-0.096 5.736-0.263 7.912-0.451 c1.932-0.193 3.863-0.546 5.789-1.013c1.36-0.283 3.006-0.828 4.933-1.642c7.011-2.849 12.514-7.222 16.523-13.117 c4.048-5.868 6.093-12.454 6.093-19.776C122.984 78.1 121.6 72.7 118.9 67.9"/>
              <path d="M182.358 53.177c-7.319-1.88-12.124-3.735-14.416-5.566c-2.292-1.829-3.435-4.181-3.435-7.054 c0-2.838 1.297-5.215 3.896-7.13c2.599-1.915 5.952-2.873 10.056-2.873c4.958 0 8.9 1.2 11.9 3.6 c2.958 2.4 4.6 5.8 4.8 10.056l11.953-0.051c-0.07-7.352-2.559-13.192-7.466-17.519c-4.908-4.327-11.483-6.49-19.725-6.49 c-8.482 0-15.279 1.976-20.391 5.926c-5.112 3.95-7.669 9.073-7.669 15.363c0 5.9 1.7 10.6 5.2 14 c3.489 3.4 9.5 6.3 17.9 8.49c0.754 0.2 1.9 0.4 3.3 0.822c6.839 1.7 11.2 3.4 13.2 5.2 c1.197 1.1 2.2 2.4 2.9 3.924c0.77 1.5 1.2 2.9 1.2 4.079c0 3.044-1.375 5.609-4.128 7.7 c-2.754 2.087-6.285 3.131-10.595 3.131c-5.711 0-10.234-1.351-13.567-4.053c-3.336-2.702-5.174-6.498-5.514-11.389h-12.212 c0.378 8.5 3.2 15 8.4 19.494c5.214 4.5 12.5 6.8 21.9 6.771c8.893 0 15.997-2.163 21.315-6.49 c5.319-4.324 7.977-10.045 7.977-17.16c0-5.882-1.7-10.465-5.104-13.746C200.73 59 193.5 56 182.4 53.2"/>
              <path d="M233.915 27.117h-11.646v15.236h-7.9v8.721h7.9v34.012c0 5 0.9 8.5 2.8 10.4 c1.899 1.9 5.2 2.9 9.8 2.924c1.366 0 3.726-0.171 7.078-0.513c0.511-0.035 0.905-0.068 1.18-0.103v-9.335l-2.308 0.1 c-0.239 0-0.609 0.018-1.105 0.051c-0.494 0.035-0.895 0.053-1.206 0.053c-1.777 0-2.99-0.333-3.639-1 c-0.651-0.668-0.976-2.01-0.976-4.027V51.074h9.234v-8.721h-9.234V27.117z"/>
              <path d="M299.373 89.498c-1.267 0-2.147-0.325-2.643-0.977c-0.497-0.648-0.745-2.032-0.745-4.153V56.922 c0-5.404-1.871-9.481-5.617-12.234c-3.744-2.754-9.293-4.13-16.647-4.13c-7.011 0-12.541 1.599-16.594 4.8 c-4.053 3.2-6.081 7.551-6.081 13.058v0.923h11.134v-0.41c0-2.805 0.957-4.959 2.872-6.465c1.916-1.505 4.667-2.257 8.259-2.257 c3.865 0 6.7 0.6 8.6 1.897c1.845 1.3 2.8 3.2 2.8 5.9c0 3.283-3.711 5.404-11.133 6.4 c-0.513 0.069-0.908 0.12-1.18 0.153c-8.893 1.129-15.03 3.104-18.416 5.924c-3.386 2.822-5.079 7.038-5.079 12.6 c0 5.1 1.6 9.1 4.7 12.056c3.164 2.9 7.5 4.4 13.1 4.36c3.626 0 7.027-0.794 10.208-2.386 c3.18-1.591 5.899-3.838 8.158-6.746c0.068 2.8 1 4.9 2.7 6.311c1.726 1.4 4.4 2.1 7.9 2.1 c0.925 0 1.89-0.069 2.899-0.205c1.009-0.139 2.044-0.345 3.104-0.616v-8.567c-0.718 0.068-1.224 0.112-1.514 0.1 C299.876 89.5 299.6 89.5 299.4 89.5 M284.547 76.878c0 3.831-1.436 6.976-4.31 9.4 c-2.873 2.464-6.481 3.694-10.825 3.694c-2.873 0-5.095-0.692-6.668-2.079c-1.574-1.384-2.36-3.341-2.36-5.874 c0-2.256 0.667-4.077 2.001-5.463c1.333-1.384 3.368-2.333 6.105-2.847c0.922-0.171 2.36-0.41 4.31-0.717 c5.369-0.787 9.284-1.814 11.747-3.079V76.878z"/>
              <path d="M341.311 86.086c-2.174 2-5.021 3.002-8.542 3.002c-4.411 0-7.78-1.634-10.105-4.9s-3.489-8.01-3.489-14.236 c0-6.359 1.174-11.173 3.515-14.439c2.342-3.267 5.805-4.901 10.389-4.901c3.419 0 6.2 1 8.3 2.8 c2.119 1.9 3.3 4.5 3.6 7.774h11.541c-0.34-6.43-2.643-11.483-6.9-15.161c-4.256-3.676-9.891-5.514-16.902-5.514 c-8.036 0-14.337 2.625-18.902 7.874c-4.566 5.25-6.849 12.492-6.849 21.726c0 9 2.2 16.2 6.6 21.4 c4.411 5.3 10.4 7.9 18 7.899c7.355 0 13.246-1.957 17.675-5.872c4.428-3.917 6.916-9.312 7.463-16.186h-11.389 C344.822 81.2 343.5 84.1 341.3 86.1"/>
              <polygon points="414,42.4 399.7,42.4 377.9,64.9 377.9,22.1 366.4,22.1 366.4,97.7 377.9,97.7 377.9,79.2 385.8,71.2 400.7,97.7 414.4,97.7 394,62.7"/>
            </svg>
          </a>
        
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <p class="caption"><span class="caption-text">はじめに</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">StackStorm 概要</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview.html#about">About</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#how-it-works">How it Works</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#what-s-next">What’s Next?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="install/index.html">インストールと設定</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install/overview.html">デプロイ後の構成</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/system_requirements.html">System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/deb.html">Ubuntu 14.04 / 16.04</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/rhel7.html">RHEL 7 / CentOS 7</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/rhel6.html">RHEL 6 / CentOS 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/docker.html">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/ansible.html">Ansible Playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/bwc.html">Extreme Workflow Composer</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/config/index.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/upgrades.html">Upgrades</a></li>
<li class="toctree-l2"><a class="reference internal" href="install/uninstall.html">Uninstall</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="start.html">クイックスタート</a><ul>
<li class="toctree-l2"><a class="reference internal" href="start.html#explore-st2-with-cli">Explore StackStorm with CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#authenticate">Authenticate</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#work-with-actions">Work with Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#define-a-rule">Define a Rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#deploy-a-rule">Deploy a Rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#deploy-examples">Deploy Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#datastore">Datastore</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">基本機能</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="actions.html">Actions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="actions.html#managing-and-running-actions">Managing and Running Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html#action-runners">Action Runners</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html#writing-custom-actions">Writing Custom Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html#built-in-parameters">Built-in Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html#overriding-runner-parameters">Overriding Runner Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html#environment-variables-available-to-actions">Environment Variables Available to Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html#converting-existing-scripts-into-actions">Converting Existing Scripts into Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html#writing-custom-python-actions">Writing Custom Python Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html#pre-defined-actions">Pre-defined Actions</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Sensors and Triggers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#sensors">Sensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#triggers">Triggers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#internal-triggers">Internal Triggers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-sensor">Creating a Sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-sensors-are-run">How Sensors are Run</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sensor-service">Sensor Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="#common-operations">Common Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#datastore-management-operations">Datastore Management Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-your-first-sensor">Running Your First Sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#debugging-a-sensor-from-a-pack">Debugging a Sensor From a Pack</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rules.html">Rules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rules.html#rule-structure">Rule Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#trigger">Trigger</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#criteria">Criteria</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#critera-comparison">Critera Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#advanced-comparison">Advanced Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#action">Action</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#variable-interpolation">Variable Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#managing-rules">Managing Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#rule-location">Rule Location</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#testing-rules">Testing Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="rules.html#timers">Timers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="workflows.html">Workflows</a><ul>
<li class="toctree-l2"><a class="reference internal" href="actionchain.html">ActionChain</a></li>
<li class="toctree-l2"><a class="reference internal" href="mistral.html">Mistral</a></li>
<li class="toctree-l2"><a class="reference internal" href="mistral_yaql.html">Mistral + YAQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="mistral_jinja.html">Mistral + Jinja</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudslang.html">CloudSlang</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="packs.html">Packs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="packs.html#what-is-a-pack">What is a Pack?</a></li>
<li class="toctree-l2"><a class="reference internal" href="packs.html#managing-packs">Managing Packs</a></li>
<li class="toctree-l2"><a class="reference internal" href="packs.html#discovering-packs">Discovering Packs</a></li>
<li class="toctree-l2"><a class="reference internal" href="packs.html#installing-a-pack">Installing a Pack</a></li>
<li class="toctree-l2"><a class="reference internal" href="packs.html#configuring-a-pack">Configuring a Pack</a></li>
<li class="toctree-l2"><a class="reference internal" href="packs.html#developing-a-pack">Developing a Pack</a></li>
<li class="toctree-l2"><a class="reference internal" href="packs.html#advanced-topics">Advanced Topics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="webhooks.html">Webhooks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="webhooks.html#sensors-vs-webhooks">Sensors vs Webhooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="webhooks.html#authentication">Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="webhooks.html#request-body">Request Body</a></li>
<li class="toctree-l2"><a class="reference internal" href="webhooks.html#registering-a-webhook">Registering a Webhook</a></li>
<li class="toctree-l2"><a class="reference internal" href="webhooks.html#using-a-generic-webhook">Using a Generic Webhook</a></li>
<li class="toctree-l2"><a class="reference internal" href="webhooks.html#listing-registered-webhooks">Listing Registered Webhooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="webhooks.html#my-webhook-isn-t-working">My Webhook Isn’t Working!</a></li>
<li class="toctree-l2"><a class="reference internal" href="webhooks.html#when-not-to-use-webhooks">When Not to Use Webhooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="datastore.html">Datastore</a><ul>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#storing-and-retrieving-key-value-pairs-via-cli">Storing and Retrieving Key-Value Pairs via CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#loading-key-value-pairs-from-a-file">Loading Key-Value Pairs from a File</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#scoping-datastore-items">Scoping Datastore Items</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#setting-a-key-value-pair-ttl">Setting a Key-Value Pair TTL</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#storing-and-retrieving-via-python-client">Storing and Retrieving via Python Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#referencing-key-value-pairs-in-rule-definitions">Referencing Key-Value Pairs in Rule Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#securing-secrets-admin-only">Securing Secrets (admin only)</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#storing-secrets">Storing Secrets</a></li>
<li class="toctree-l2"><a class="reference internal" href="datastore.html#security-notes">Security notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chatops/index.html">ChatOps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chatops/chatops.html">What is ChatOps?</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatops/chatops.html#architecture">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatops/chatops.html#stackstorm-flavored-chatops">StackStorm-flavored ChatOps</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatops/chatops.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatops/chatops.html#adding-new-chatops-commands">Adding New ChatOps Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatops/chatops.html#logging">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatops/aliases.html">Action Aliases</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatops/notifications.html">Notifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatops/pack_deploy.html">Pack Deployment</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">応用トピック</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Authentication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#configuring-the-service">Configuring the Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#auth-backends">Auth Backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#ldap-enterprise-edition">LDAP (Enterprise Edition)</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#running-the-service">Running the Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#testing">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication.html#api-keys">API Keys</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rbac.html">Role Based Access Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#terminology">Terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#system-roles">System Roles</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#how-it-works">How it Works</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#enabling-rbac">Enabling RBAC</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#defining-roles-and-assignments">Defining Roles and Assignments</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#applying-rbac-definitions">Applying RBAC Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#automatically-granting-roles-based-on-ldap-group-membership">Automatically Granting Roles Based on LDAP Group Membership</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbac.html#using-rbac-example">Using RBAC Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="inquiries.html">Inquiries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="inquiries.html#new-core-ask-action">New <code class="docutils literal"><span class="pre">core.ask</span></code> Action</a></li>
<li class="toctree-l2"><a class="reference internal" href="inquiries.html#using-core-ask-in-a-workflow">Using <code class="docutils literal"><span class="pre">core.ask</span></code> in a Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="inquiries.html#notifying-users-of-inquiries-using-rules">Notifying Users of Inquiries using Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="inquiries.html#responding-to-an-inquiry">Responding to an Inquiry</a></li>
<li class="toctree-l2"><a class="reference internal" href="inquiries.html#securing-inquiries">Securing Inquiries</a></li>
<li class="toctree-l2"><a class="reference internal" href="inquiries.html#garbage-collection-for-inquiries">Garbage Collection for Inquiries</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference/index.html">References and Guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="reference/sharing_code_sensors_actions.html">Sharing code between Sensors and Python Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/cli.html">CLI Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/pack_configs.html">Pack Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/packs.html">Create and Contribute a Pack</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/pack_management_transition.html">Pack Management Transition</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/action_output_streaming.html">Real-time Action Output Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/jinja.html">Jinja</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/policies.html">Policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/runners.html">Action Runners</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/traces.html">Traces</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/client_libraries.html">Client Libraries and Language Bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/ha.html">High Availability Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/api.html">REST API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/monitoring.html">System Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/sensor_partitioning.html">Partitioning Sensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/history.html">History and Audit</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/secrets_masking.html">Secrets Masking</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting/index.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/self_verification.html">Running Self-Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/basic_chatops_troubleshooting.html">ChatOps Troubleshooting Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/rules.html">Rule is not Being Matched</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/sensors.html">Sensor Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/mistral.html">Mistral Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/ssh.html">SSH Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/database.html">Database Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/rest_api_access.html">REST API access</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/tuning_action_runner_dispatcher_pool.html">Tuning Action Runner Dispatcher Pool Size</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/purging_old_data.html">Purging Old Operational Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/private_networks.html">WebUI Access on Private Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/submit_debug_info.html">Submitting Debugging Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/debug_mode.html">Enabling Debug Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/ask_for_support.html">Ask for help!</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting/webhooks.html">Troubleshooting Webhooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="development/index.html">Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="development/index.html#contributing">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="development/index.html#setting-up-a-development-environment">Setting up a Development Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="development/index.html#general-contribution-guidelines">General Contribution Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="development/index.html#code-style-guide">Code Style Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="development/index.html#deprecation-policy">Deprecation Policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="development/index.html#general-coding-guidelines">General Coding Guidelines</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Release Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#in-development">in development</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#january-19-2018">2.6.0 - January 19, 2018</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#december-14-2017">2.5.1 - December 14, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#october-25-2017">2.5.0 - October 25, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#september-12-2017">2.4.1 - September 12, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#august-23-2017">2.4.0 - August 23, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#july-28-2017">2.3.2 - July 28, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#july-07-2017">2.3.1 - July 07, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#june-19-2017">2.3.0 - June 19, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#april-3-2017">2.2.1 - April 3, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#february-27-2017">2.2.0 - February 27, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#december-16-2016">2.1.1 - December 16, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#december-05-2016">2.1.0 - December 05, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#september-30-2016">2.0.1 - September 30, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#august-31-2016">2.0.0 - August 31, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#august-8-2016">1.6.0 - August 8, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#july-13-2016">1.5.1 - July 13, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#june-24-2016">1.5.0 - June 24, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#april-18-2016">1.4.0 - April 18, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#february-12-2016">1.3.2 - February 12, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#january-25-2016">1.3.1 - January 25, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#january-22-2016">1.3.0 - January 22, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#december-07-2015">1.2.0 - December 07, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#november-13-2015">1.1.1 - November 13, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#october-27-2015">1.1.0 - October 27, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#september-09-2015">0.13.2 - September 09, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#august-28-2015">0.13.1 - August 28, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#august-24-2015">0.13.0 - August 24, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#august-11-2015">0.12.2 - August 11, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#july-31-2015">0.12.1 - July 31, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#july-20-2015">0.12.0 - July 20, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#july-2-2015">0.11.6 - July 2, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#july-1-2015">0.11.5 - July 1, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#june-30-2015">0.11.4 - June 30, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#june-16-2015">0.11.3 - June 16, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#june-12-2015">0.11.2 - June 12, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#june-8-2015">0.11.1 - June 8, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#june-5-2015">0.11.0 - June 5, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-9-2-may-26-2015">v0.9.2 - May 26, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-9-1-may-12-2015">v0.9.1 - May 12, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-9-0-april-29-2015">v0.9.0 - April 29, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-8-3-march-23-2015">v0.8.3 - March 23, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-8-2-march-10-2015">v0.8.2 - March 10, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-8-1-march-10-2015">v0.8.1 - March 10, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-8-0-march-2-2015">v0.8.0 - March 2, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-7-january-16-2015">v0.7 - January 16, 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-6-0-december-8-2014">v0.6.0 - December 8, 2014</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-5-1-november-3rd-2014">v0.5.1 - November 3rd, 2014</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="upgrade_notes.html">Upgrade Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v2-6">StackStorm v2.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v2-5">StackStorm v2.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v2-4">StackStorm v2.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v2-3">StackStorm v2.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v2-2">StackStorm v2.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v2-1">StackStorm v2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v2-0">StackStorm v2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v1-6">StackStorm v1.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v1-5">StackStorm v1.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v1-4">StackStorm v1.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v1-3">StackStorm v1.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v1-2">StackStorm v1.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v1-1">StackStorm v1.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v-0-11">StackStorm v 0.11</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade_notes.html#st2-v0-9">StackStorm v0.9</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap</a><ul>
<li class="toctree-l2"><a class="reference internal" href="roadmap.html#release-history">Release History</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">StackStorm</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs v2.7dev </a> &raquo;</li>
        
      <li>Sensors and Triggers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/StackStorm/st2docs/blob/master/docs/source/sensors.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document">
            <div id="version-warning" class="admonition warning hide">
              <p class="first admonition-title">Note</p>
              <p class="last">
                The documentation you're currently reading is for version 2.7dev.
                Click <a href="/">here</a> to view documentation for the latest stable version.
              </p>
            </div>
            
  <div class="section" id="sensors-and-triggers">
<h1>Sensors and Triggers<a class="headerlink" href="#sensors-and-triggers" title="Permalink to this headline">¶</a></h1>
<div class="section" id="sensors">
<h2>Sensors<a class="headerlink" href="#sensors" title="Permalink to this headline">¶</a></h2>
<p>Sensors are a way to integrate external systems and events with StackStorm. Sensors are pieces of
Python code that either periodically poll some external system, or passively wait for inbound
events. They then inject triggers into StackStorm, which can be matched by rules, for potential action
execution.</p>
<p>Sensors are written in Python, and must follow the StackStorm-defined sensor interface requirements.</p>
</div>
<div class="section" id="triggers">
<h2>Triggers<a class="headerlink" href="#triggers" title="Permalink to this headline">¶</a></h2>
<p>Triggers are StackStorm constructs that identify the incoming events to StackStorm. A trigger is a tuple of
type (string) and optional parameters (object). Rules are written to work with triggers. Sensors
typically register triggers though this is not strictly required. For example, there is a generic
<a class="reference internal" href="webhooks.html"><span class="doc">webhooks</span></a> trigger registered with StackStorm, which does not require a custom sensor.</p>
</div>
<div class="section" id="internal-triggers">
<h2>Internal Triggers<a class="headerlink" href="#internal-triggers" title="Permalink to this headline">¶</a></h2>
<p>By default StackStorm emits some internal triggers which you can leverage in rules. Those triggers can
be distinguished from non-system triggers since they are prefixed with <code class="docutils literal"><span class="pre">st2.</span></code>.</p>
<p>A list of available triggers for each resource is included below:</p>
<div class="section" id="action">
<h3>Action<a class="headerlink" href="#action" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="32%" />
<col width="54%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Reference</th>
<th class="head">Description</th>
<th class="head">Properties</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>st2.generic.actiontrigger</td>
<td>Trigger encapsulating the completion of an action execution.</td>
<td>status, start_timestamp, result, parameters, action_ref, runner_ref, execution_id, action_name</td>
</tr>
<tr class="row-odd"><td>st2.generic.notifytrigger</td>
<td>Notification trigger.</td>
<td>status, data, start_timestamp, channel, route, action_ref, message, runner_ref, execution_id, end_timestamp</td>
</tr>
<tr class="row-even"><td>st2.action.file_writen</td>
<td>Trigger encapsulating action file being written on disk.</td>
<td>host_info, ref, file_path</td>
</tr>
<tr class="row-odd"><td>st2.generic.inquiry</td>
<td>Trigger indicating a new “inquiry” has entered “pending” status</td>
<td>route, id</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="key-value-pair">
<h3>Key Value Pair<a class="headerlink" href="#key-value-pair" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="50%" />
<col width="21%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Reference</th>
<th class="head">Description</th>
<th class="head">Properties</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>st2.key_value_pair.create</td>
<td>Trigger encapsulating datastore item creation.</td>
<td>object</td>
</tr>
<tr class="row-odd"><td>st2.key_value_pair.update</td>
<td>Trigger encapsulating datastore set action.</td>
<td>object</td>
</tr>
<tr class="row-even"><td>st2.key_value_pair.value_change</td>
<td>Trigger encapsulating a change of datastore item value.</td>
<td>new_object, old_object</td>
</tr>
<tr class="row-odd"><td>st2.key_value_pair.delete</td>
<td>Trigger encapsulating datastore item deletion.</td>
<td>object</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sensor">
<h3>Sensor<a class="headerlink" href="#sensor" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="57%" />
<col width="14%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Reference</th>
<th class="head">Description</th>
<th class="head">Properties</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>st2.sensor.process_spawn</td>
<td>Trigger indicating sensor process is started up.</td>
<td>object</td>
</tr>
<tr class="row-odd"><td>st2.sensor.process_exit</td>
<td>Trigger indicating sensor process is stopped.</td>
<td>object</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="creating-a-sensor">
<span id="ref-sensors-authoring-a-sensor"></span><h2>Creating a Sensor<a class="headerlink" href="#creating-a-sensor" title="Permalink to this headline">¶</a></h2>
<p>Creating a sensor involves writing a Python file and a YAML metadata file that defines the sensor.
Here’s a minimal skeleton example. This is the metadata file:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="nn">---</span>
  <span class="l l-Scalar l-Scalar-Plain">class_name</span><span class="p p-Indicator">:</span> <span class="s">&quot;SampleSensor&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">entry_point</span><span class="p p-Indicator">:</span> <span class="s">&quot;sample_sensor.py&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;Sample</span><span class="nv"> </span><span class="s">sensor</span><span class="nv"> </span><span class="s">that</span><span class="nv"> </span><span class="s">emits</span><span class="nv"> </span><span class="s">triggers.&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">trigger_types</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span>
      <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;event&quot;</span>
      <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;An</span><span class="nv"> </span><span class="s">example</span><span class="nv"> </span><span class="s">trigger.&quot;</span>
      <span class="l l-Scalar l-Scalar-Plain">payload_schema</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;object&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">properties</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">executed_at</span><span class="p p-Indicator">:</span>
            <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;string&quot;</span>
            <span class="l l-Scalar l-Scalar-Plain">format</span><span class="p p-Indicator">:</span> <span class="s">&quot;date-time&quot;</span>
            <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="s">&quot;2014-07-30</span><span class="nv"> </span><span class="s">05:04:24.578325&quot;</span>
</pre></div>
</div>
<p>And this is the corresponding Python skeleton:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">st2reactor.sensor.base</span> <span class="kn">import</span> <span class="n">Sensor</span>


<span class="k">class</span> <span class="nc">SampleSensor</span><span class="p">(</span><span class="n">Sensor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    * self.sensor_service</span>
<span class="sd">        - provides utilities like</span>
<span class="sd">            - get_logger() - returns logger instance specific to this sensor.</span>
<span class="sd">            - dispatch() for dispatching triggers into the system.</span>
<span class="sd">    * self._config</span>
<span class="sd">        - contains parsed configuration that was specified as</span>
<span class="sd">          config.yaml in the pack.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Setup stuff goes here. For example, you might establish connections</span>
        <span class="c1"># to external system once and reuse it. This is called only once by the system.</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># This is where the crux of the sensor work goes.</span>
        <span class="c1"># This is called once by the system.</span>
        <span class="c1"># (If you want to sleep for regular intervals and keep</span>
        <span class="c1"># interacting with your external system, you&#39;d inherit from PollingSensor.)</span>
        <span class="c1"># For example, let&#39;s consider a simple flask app. You&#39;d run the flask app here.</span>
        <span class="c1"># You can dispatch triggers using sensor_service like so:</span>
        <span class="c1"># self.sensor_service(trigger, payload, trace_tag)</span>
        <span class="c1">#   # You can refer to the trigger as dict</span>
        <span class="c1">#   # { &quot;name&quot;: ${trigger_name}, &quot;pack&quot;: ${trigger_pack} }</span>
        <span class="c1">#   # or just simply by reference as string.</span>
        <span class="c1">#   # i.e. dispatch(${trigger_pack}.${trigger_name}, payload)</span>
        <span class="c1">#   # E.g.: dispatch(&#39;examples.foo_sensor&#39;, {&#39;k1&#39;: &#39;stuff&#39;, &#39;k2&#39;: &#39;foo&#39;})</span>
        <span class="c1">#   # trace_tag is a tag you would like to associate with the dispatched TriggerInstance</span>
        <span class="c1">#   # Typically the trace_tag is unique and a reference to an external event.</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># This is called when the st2 system goes down. You can perform cleanup operations like</span>
        <span class="c1"># closing the connections to external system here.</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">add_trigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger</span><span class="p">):</span>
        <span class="c1"># This method is called when trigger is created</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">update_trigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger</span><span class="p">):</span>
        <span class="c1"># This method is called when trigger is updated</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">remove_trigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger</span><span class="p">):</span>
        <span class="c1"># This method is called when trigger is deleted</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p>This is a bare minimum version of what a sensor looks like. For a more complete implementation of
a sensor that actually injects triggersinto the system, look at the <a class="reference external" href="#examples">examples</a>
section below.</p>
<p>Your sensor should generate triggers in Python dict form:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">trigger</span> <span class="o">=</span> <span class="s1">&#39;pack.name&#39;</span>
<span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;executed_at&#39;</span><span class="p">:</span> <span class="s1">&#39;2014-08-01T00:00:00.000000Z&#39;</span>
<span class="p">}</span>
<span class="n">trace_tag</span> <span class="o">=</span> <span class="n">external_event_id</span>
</pre></div>
</div>
<p>The sensor injects such triggers by using the sensor_service passed into the sensor on
instantiation.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">sensor_service</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="n">trigger</span><span class="o">=</span><span class="n">trigger</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">trace_tag</span><span class="o">=</span><span class="n">trace_tag</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want a sensor that polls an external system at regular intervals, you can use a
PollingSensor instead of Sensor as the base class.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">st2reactor.sensor.base</span> <span class="kn">import</span> <span class="n">PollingSensor</span>


<span class="k">class</span> <span class="nc">SamplePollingSensor</span><span class="p">(</span><span class="n">PollingSensor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    * self.sensor_service</span>
<span class="sd">        - provides utilities like</span>
<span class="sd">            get_logger() for writing to logs.</span>
<span class="sd">            dispatch() for dispatching triggers into the system.</span>
<span class="sd">    * self._config</span>
<span class="sd">        - contains configuration that was specified as</span>
<span class="sd">          config.yaml in the pack.</span>
<span class="sd">    * self._poll_interval</span>
<span class="sd">        - indicates the interval between two successive poll() calls.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Setup stuff goes here. For example, you might establish connections</span>
        <span class="c1"># to external system once and reuse it. This is called only once by the system.</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">poll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># This is where the crux of the sensor work goes.</span>
        <span class="c1"># This is called every self._poll_interval.</span>
        <span class="c1"># For example, let&#39;s assume you want to query ec2 and get</span>
        <span class="c1"># health information about your instances:</span>
        <span class="c1">#   some_data = aws_client.get(&#39;&#39;)</span>
        <span class="c1">#   payload = self._to_payload(some_data)</span>
        <span class="c1">#   # _to_triggers is something you&#39;d write to convert the data format you have</span>
        <span class="c1">#   # into a standard python dictionary. This should follow the payload schema</span>
        <span class="c1">#   # registered for the trigger.</span>
        <span class="c1">#   self.sensor_service.dispatch(trigger, payload)</span>
        <span class="c1">#   # You can refer to the trigger as dict</span>
        <span class="c1">#   # { &quot;name&quot;: ${trigger_name}, &quot;pack&quot;: ${trigger_pack} }</span>
        <span class="c1">#   # or just simply by reference as string.</span>
        <span class="c1">#   # i.e. dispatch(${trigger_pack}.${trigger_name}, payload)</span>
        <span class="c1">#   # E.g.: dispatch(&#39;examples.foo_sensor&#39;, {&#39;k1&#39;: &#39;stuff&#39;, &#39;k2&#39;: &#39;foo&#39;})</span>
        <span class="c1">#   # trace_tag is a tag you would like to associate with the dispatched TriggerInstance</span>
        <span class="c1">#   # Typically the trace_tag is unique and a reference to an external event.</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># This is called when the st2 system goes down. You can perform cleanup operations like</span>
        <span class="c1"># closing the connections to external system here.</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">add_trigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger</span><span class="p">):</span>
        <span class="c1"># This method is called when trigger is created</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">update_trigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger</span><span class="p">):</span>
        <span class="c1"># This method is called when trigger is updated</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">remove_trigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger</span><span class="p">):</span>
        <span class="c1"># This method is called when trigger is deleted</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p>Polling Sensors also require a <code class="docutils literal"><span class="pre">poll_interval</span></code> parameter in the metadata file. This defines
(in seconds) how frequently the <code class="docutils literal"><span class="pre">poll()</span></code> method is called.</p>
</div>
<div class="section" id="how-sensors-are-run">
<h2>How Sensors are Run<a class="headerlink" href="#how-sensors-are-run" title="Permalink to this headline">¶</a></h2>
<p>Each sensor runs as a separate process. The <code class="docutils literal"><span class="pre">st2sensorcontainer</span></code> (see
<a class="reference internal" href="install/overview.html"><span class="doc">Overview</span></a>) starts <code class="docutils literal"><span class="pre">sensor_wrapper.py</span></code> which wraps your Sensor class
(such as <code class="docutils literal"><span class="pre">SampleSensor</span></code> or <code class="docutils literal"><span class="pre">SamplePollingSensor</span></code> above) in a
<a class="reference internal" href="#ref-sensors-authoring-a-sensor"><span class="std std-ref">st2reactor.container.sensor_wrapper.SensorWrapper</span></a>.</p>
</div>
<div class="section" id="sensor-service">
<h2>Sensor Service<a class="headerlink" href="#sensor-service" title="Permalink to this headline">¶</a></h2>
<p>As you can see in the example above, a <code class="docutils literal"><span class="pre">sensor_service</span></code> is passed to each sensor class
constructor on instantiation.</p>
<p>The Sensor service provides different services to the sensor via public methods. The most
important one is the <code class="docutils literal"><span class="pre">dispatch</span></code> method which allows sensors to inject triggers into the system.</p>
<p>All public methods are described below:</p>
</div>
<div class="section" id="common-operations">
<h2>Common Operations<a class="headerlink" href="#common-operations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dispatch-trigger-payload-trace-tag">
<h3>1. dispatch(trigger, payload, trace_tag)<a class="headerlink" href="#dispatch-trigger-payload-trace-tag" title="Permalink to this headline">¶</a></h3>
<p>This method allows the sensor to inject triggers into the system.</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">trigger</span> <span class="o">=</span> <span class="s1">&#39;pack.name&#39;</span>
<span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;executed_at&#39;</span><span class="p">:</span> <span class="s1">&#39;2014-08-01T00:00:00.000000Z&#39;</span>
<span class="p">}</span>
<span class="n">trace_tag</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>

<span class="bp">self</span><span class="o">.</span><span class="n">sensor_service</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="n">trigger</span><span class="o">=</span><span class="n">trigger</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">trace_tag</span><span class="o">=</span><span class="n">trace_tag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="get-logger-name">
<h3>2. get_logger(name)<a class="headerlink" href="#get-logger-name" title="Permalink to this headline">¶</a></h3>
<p>This method allows the sensor instance to retrieve the logger instance which is specific
to that sensor.</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">_logger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_service</span><span class="o">.</span><span class="n">get_logger</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Polling 3rd party system for information&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="datastore-management-operations">
<span id="ref-sensors-datastore-management-operations"></span><h2>Datastore Management Operations<a class="headerlink" href="#datastore-management-operations" title="Permalink to this headline">¶</a></h2>
<p>In addition to the trigger injection, the sensor service also provides functionality for reading
and manipulating the <a class="reference internal" href="datastore.html"><span class="doc">datastore</span></a>.</p>
<p>Each sensor has a namespace which is local to it and by default, all the datastore operations
operate on the keys in that sensor-local namespace. If you want to operate on a global namespace,
you need to pass the <code class="docutils literal"><span class="pre">local=False</span></code> argument to the datastore manipulation method.</p>
<p>Among other reasons, this functionality is useful if you want to persist temporary data between
sensor runs.</p>
<p>A good example of this functionality in action is <code class="docutils literal"><span class="pre">TwitterSensor</span></code>. The Twitter sensor persists
the ID of the last processed tweet after every poll in the datastore. This way if the sensor is
restarted or if it crashes, the sensor can resume from where it left off without injecting
duplicate triggers into the system.</p>
<p>For the implementation, see <a class="reference external" href="https://github.com/StackStorm-Exchange/twitter/tree/master/sensors/twitter_search_sensor.py">twitter_search_sensor.py in
StackStorm Exchange</a></p>
<div class="section" id="list-values-local-true-prefix-none">
<h3>1. list_values(local=True, prefix=None)<a class="headerlink" href="#list-values-local-true-prefix-none" title="Permalink to this headline">¶</a></h3>
<p>This method allows you to list the values in the datastore. You can also filter by key name prefix
(key name starts with) by passing <code class="docutils literal"><span class="pre">prefix</span></code> argument to the method:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">kvps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_service</span><span class="o">.</span><span class="n">list_values</span><span class="p">(</span><span class="n">local</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;cmdb.&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">kvp</span> <span class="ow">in</span> <span class="n">kvps</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">kvp</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">kvp</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="get-value-name-local-true-decrypt-false">
<h3>2. get_value(name, local=True, decrypt=False)<a class="headerlink" href="#get-value-name-local-true-decrypt-false" title="Permalink to this headline">¶</a></h3>
<p>This method allows you to retrieve a single value from the datastore:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">kvp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_service</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s1">&#39;cmdb.api_host&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">kvp</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>If the value is encrypted, you can decrypt it with this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">kvp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_service</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s1">&#39;cmdb.api_password&#39;</span><span class="p">,</span> <span class="n">decrypt</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">kvp</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="set-value-name-value-ttl-none-local-true-encrypt-false">
<h3>3. set_value(name, value, ttl=None, local=True, encrypt=False)<a class="headerlink" href="#set-value-name-value-ttl-none-local-true-encrypt-false" title="Permalink to this headline">¶</a></h3>
<p>This method allows you to store (set) a value in the datastore. Optionally you can also specify
time to live (TTL) for the stored value:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">last_id</span> <span class="o">=</span> <span class="mi">12345</span>
<span class="bp">self</span><span class="o">.</span><span class="n">sensor_service</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;last_id&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">last_id</span><span class="p">))</span>
</pre></div>
</div>
<p>Secret values can be encrypted in the datastore:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">ma_password</span> <span class="o">=</span> <span class="s1">&#39;Sup3rS34et&#39;</span>
<span class="bp">self</span><span class="o">.</span><span class="n">sensor_service</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ma_password&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">ma_password</span><span class="p">,</span> <span class="n">encrypt</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="delete-value-name-local-true">
<h3>4. delete_value(name, local=True)<a class="headerlink" href="#delete-value-name-local-true" title="Permalink to this headline">¶</a></h3>
<p>This method allows you to delete an existing value from the datastore. If a value is not found this
method will return <code class="docutils literal"><span class="pre">False</span></code>, <code class="docutils literal"><span class="pre">True</span></code> otherwise.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">sensor_service</span><span class="o">.</span><span class="n">delete_value</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;my_key&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="api-docs">
<span id="ref-sensors-api-docs"></span><h3>API Docs<a class="headerlink" href="#api-docs" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="st2reactor.container.sensor_wrapper.SensorService">
<em class="property">class </em><code class="descclassname">st2reactor.container.sensor_wrapper.</code><code class="descname">SensorService</code><span class="sig-paren">(</span><em>sensor_wrapper</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/st2reactor/container/sensor_wrapper.html#SensorService"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#st2reactor.container.sensor_wrapper.SensorService" title="Permalink to this definition">¶</a></dt>
<dd><p>Instance of this class is passed to the sensor instance and exposes “public”
methods which can be called by the sensor.</p>
<dl class="method">
<dt id="st2reactor.container.sensor_wrapper.SensorService.dispatch">
<code class="descname">dispatch</code><span class="sig-paren">(</span><em>trigger</em>, <em>payload=None</em>, <em>trace_tag=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/st2reactor/container/sensor_wrapper.html#SensorService.dispatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#st2reactor.container.sensor_wrapper.SensorService.dispatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Method which dispatches the trigger.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>trigger</strong> (<code class="docutils literal"><span class="pre">str</span></code>) – Full name / reference of the trigger.</li>
<li><strong>payload</strong> (<code class="docutils literal"><span class="pre">dict</span></code>) – Trigger payload.</li>
<li><strong>trace_tag</strong> – Tracer to track the triggerinstance.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="st2reactor.container.sensor_wrapper.SensorService.dispatch_with_context">
<code class="descname">dispatch_with_context</code><span class="sig-paren">(</span><em>trigger</em>, <em>payload=None</em>, <em>trace_context=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/st2reactor/container/sensor_wrapper.html#SensorService.dispatch_with_context"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#st2reactor.container.sensor_wrapper.SensorService.dispatch_with_context" title="Permalink to this definition">¶</a></dt>
<dd><p>Method which dispatches the trigger.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>trigger</strong> (<code class="docutils literal"><span class="pre">str</span></code>) – Full name / reference of the trigger.</li>
<li><strong>payload</strong> (<code class="docutils literal"><span class="pre">dict</span></code>) – Trigger payload.</li>
<li><strong>trace_context</strong> (<code class="docutils literal"><span class="pre">st2common.api.models.api.trace.TraceContext</span></code>) – Trace context to associate with Trigger.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="st2reactor.container.sensor_wrapper.SensorService.get_logger">
<code class="descname">get_logger</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/st2reactor/container/sensor_wrapper.html#SensorService.get_logger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#st2reactor.container.sensor_wrapper.SensorService.get_logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve an instance of a logger to be used by the sensor class.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="running-your-first-sensor">
<h2>Running Your First Sensor<a class="headerlink" href="#running-your-first-sensor" title="Permalink to this headline">¶</a></h2>
<p>Once you write your own sensor, the following steps can be used to run your sensor for the first
time:</p>
<ol class="arabic">
<li><p class="first">Place the sensor Python file and YAML metadata in the <code class="docutils literal"><span class="pre">default</span></code> pack in
<code class="docutils literal"><span class="pre">/opt/stackstorm/packs/default/sensors/</span></code>. Alternatively, you can create a custom
pack in <code class="docutils literal"><span class="pre">/opt/stackstorm/packs/</span></code> with the appropriate pack structure (see
<a class="reference internal" href="reference/packs.html"><span class="doc">Create and Contribute a Pack</span></a>) and place the sensor artifacts there.</p>
</li>
<li><p class="first">Register the sensor with <code class="docutils literal"><span class="pre">st2ctl</span></code>. Watch for any errors in sensor registration:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>st2ctl reload --register-all
</pre></div>
</div>
<p>If there are errors in registration, fix the errors and re-register them using
<code class="docutils literal"><span class="pre">st2ctl</span> <span class="pre">reload</span> <span class="pre">--register-all</span></code>.</p>
</li>
<li><p class="first">If registration is successful, the sensor will run automatically.</p>
</li>
</ol>
<p>Once you like your sensor, you can promote it to a pack (if required) by creating a pack in
<code class="docutils literal"><span class="pre">/opt/stackstorm/packs/${pack_name}</span></code> and moving the sensor artifacts (YAML and Python) to
<code class="docutils literal"><span class="pre">/opt/stackstorm/packs/${pack_name}/sensors/</span></code>. See <a class="reference internal" href="reference/packs.html"><span class="doc">Create and Contribute a Pack</span></a> for how to create a pack.</p>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>This is a working example of a simple sensor that injects a trigger every 10 seconds.</p>
<p>Metadata:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">class_name</span><span class="p p-Indicator">:</span> <span class="s">&quot;HelloSensor&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">entry_point</span><span class="p p-Indicator">:</span> <span class="s">&quot;sensor1.py&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;Test</span><span class="nv"> </span><span class="s">sensor</span><span class="nv"> </span><span class="s">that</span><span class="nv"> </span><span class="s">emits</span><span class="nv"> </span><span class="s">triggers.&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">trigger_types</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span>
    <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;event1&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="s">&quot;An</span><span class="nv"> </span><span class="s">example</span><span class="nv"> </span><span class="s">trigger.&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">payload_schema</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;object&quot;</span>
</pre></div>
</div>
<p>Python code:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">eventlet</span>

<span class="kn">from</span> <span class="nn">st2reactor.sensor.base</span> <span class="kn">import</span> <span class="n">Sensor</span>


<span class="k">class</span> <span class="nc">HelloSensor</span><span class="p">(</span><span class="n">Sensor</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensor_service</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">HelloSensor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">sensor_service</span><span class="o">=</span><span class="n">sensor_service</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_service</span><span class="o">.</span><span class="n">get_logger</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stop</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;HelloSensor dispatching trigger...&#39;</span><span class="p">)</span>
            <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_service</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s1">&#39;hello_st2.count&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;greeting&#39;</span><span class="p">:</span> <span class="s1">&#39;Yo, StackStorm!&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sensor_service</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="n">trigger</span><span class="o">=</span><span class="s1">&#39;hello_st2.event1&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sensor_service</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s1">&#39;hello_st2.count&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">])</span>
            <span class="n">eventlet</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stop</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="c1"># Methods required for programmable sensors.</span>
    <span class="k">def</span> <span class="nf">add_trigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">update_trigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">remove_trigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trigger</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p>The <a class="reference external" href="https://exchange.stackstorm.org">StackStorm Exchange</a> has many more examples.
Here’s just a few:</p>
<div class="section" id="passive-sensors">
<h3>Passive Sensors<a class="headerlink" href="#passive-sensors" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://github.com/StackStorm-Exchange/irc/tree/master/sensors/irc_sensor.py">IRC</a></li>
<li><a class="reference external" href="https://github.com/StackStorm-Exchange/kafka/tree/master/sensors/message_sensor.py">Kafka Messages</a></li>
<li><a class="reference external" href="https://github.com/StackStorm-Exchange/rabbitmq/tree/master/sensors/queues_sensor.py">RabbitMQ Queues</a></li>
</ul>
</div>
<div class="section" id="polling-sensors">
<h3>Polling Sensors<a class="headerlink" href="#polling-sensors" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://github.com/StackStorm-Exchange/github/tree/master/sensors/github_repository_sensor.py">Github repository monitoring</a></li>
<li><a class="reference external" href="https://github.com/StackStorm-Exchange/jira/tree/master/sensors/jira_sensor.py">Jira issues</a></li>
<li><a class="reference external" href="https://github.com/StackStorm-Exchange/twitter/tree/master/sensors/twitter_search_sensor.py">Twitter search</a></li>
</ul>
</div>
</div>
<div class="section" id="debugging-a-sensor-from-a-pack">
<h2>Debugging a Sensor From a Pack<a class="headerlink" href="#debugging-a-sensor-from-a-pack" title="Permalink to this headline">¶</a></h2>
<p>If you just want to run a single sensor from a pack and the sensor is already registered, you can
use the <code class="docutils literal"><span class="pre">st2sensorcontainer</span></code> to run just that single sensor:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>/opt/stackstorm/st2/bin/st2sensorcontainer --config-file<span class="o">=</span>/etc/st2/st2.conf --sensor-ref<span class="o">=</span>pack.SensorClassName
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>/opt/stackstorm/st2/bin/st2sensorcontainer --config-file<span class="o">=</span>/etc/st2/st2.conf --sensor-ref<span class="o">=</span>git.GitCommitSensor
</pre></div>
</div>
<div class="section" id="sharing-code-between-python-sensors-and-actions">
<h3>Sharing code between Python Sensors and Actions<a class="headerlink" href="#sharing-code-between-python-sensors-and-actions" title="Permalink to this headline">¶</a></h3>
<p>Refer to <a class="reference internal" href="reference/sharing_code_sensors_actions.html#ref-shared-libs-python-sensors-actions"><span class="std std-ref">documentation</span></a> on sharing common code
between python actions and sensors.</p>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="rules.html" class="btn btn-neutral float-right" title="Rules">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="actions.html" class="btn btn-neutral" title="Actions"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014 - 2018, StackStorm.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  
  <div id="versions"></div>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.7dev',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  

  <script type="text/javascript" src="/_static/js/versions.js"></script> 

</body>
</html>